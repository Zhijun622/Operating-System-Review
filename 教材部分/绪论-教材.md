# 绪论

第1章
第1 章导读


--- Page 23 ---
2
计算机操作系统 （慕课版）
1.1 操作系统的目标和作用
OS的目标与应用环境有关。例如，针对应用于查询系统的OS，希望其能具备好的人机交互
性；针对应用于工业控制、武器控制以及多媒体环境的OS，希望其具有实时性；而针对微型计
算机（简称微机）上配置的OS，则更看重其使用的方便性。
1.1.1 操作系统的目标
在计算机系统上配置OS，其主要目标是实现：方便性、有效性、可扩充性、开放性。
1．方便性
一个未配置OS的计算机系统是极难使用的。用户如果想直接在计算机硬件上运行自己所编
写的程序，就必须用机器语言编写程序。但如果在计算机硬件上配置了OS，则可以使用编译命
令将用户采用高级语言编写的程序翻译成机器代码，或者直接通过OS所提供的各种命令来操纵
计算机系统，这极大地方便了用户，也使计算机变得易学、易用。
2．有效性
有效性所包含的第一层含义是提高系统资源的利用率。在早期未配置OS 的计算机系统中，
诸如处理机、输入/输出（input/output，I/O）设备等都经常处于空闲状态，各种资源无法得到充
分利用，因此在当时，提高系统资源利用率是推动OS发展最主要的动力。有效性的第二层含义
是提高系统的吞吐量。OS可以通过合理地组织计算机的工作流程，加速程序的运行，缩短程序
的运行周期来提高系统的吞吐量。
方便性和有效性是设计OS 时最重要的两个目标。在过去很长一段时间内，由于计算机系统
非常昂贵，有效性显得特别重要。然而，近十几年来，随着硬件越来越便宜，在设计配置在微
机上的OS时，似乎更加重视如何提高用户使用计算机的方便性。因此，在微机操作系统中都配
置了深受用户欢迎的图形用户界面，并为程序员提供了大量的系统调用，方便了用户对计算机
的使用。
3．可扩充性
为适应计算机硬件、体系结构以及应用发展的要求，OS 必须具有很好的可扩充性。可扩充
性的好坏与OS的结构有着十分紧密的联系，由此推动了OS结构的不断发展。OS从早期的无结
构发展成模块化结构，进而又发展成分层式结构，近年来OS已广泛采用微内核结构。该结构能
方便地增添新的功能和模块，以及对原有功能和模块进行修改，具有良好的可扩充性。
4．开放性
随着计算机应用的日益普及，计算机硬件和软件的兼容性问题提到了议事日程中。世界各
国相应地制定了一系列的软硬件标准，这使得不同厂家按照标准而生产的软硬件都能在本国范
围内很好地相互兼容。这无疑给用户带来了极大的方便，也给产品的推广与应用铺平了道路。
近年来，随着互联网的迅速发展，计算机OS的应用环境也由单处理机环境转向了网络环境。因
此，其应用环境必须更为开放，这就对OS的开放性提出了更高的要求。
所谓开放性，是指系统能够遵循国际标准，特别是遵循开放系统互连（ open system  
interconnect，OSI）参考模型。事实上，凡遵循国际标准而开发的硬件和软件都能彼此兼容，并

--- Page 24 ---
3
第
1章 
操作系统引论
方便地实现互连。开放性已成为20世纪90年代以后计算机技术的一个核心问题，也是衡量一个
新推出的系统或软件能否被广泛应用的重要因素。
用户使用方便和计算机高效运行是 OS 的两个主要目标， 请思考这两个目标是否存在矛盾？
它们在什么时候是矛盾的？在什么时候是不矛盾（一致）的？
思考题
1.1.2 操作系统的作用
可以从人机交互、资源管理及资源抽象等不同方面来分析OS在计算机系统中所起的作用。
1．OS 作为用户与计算机硬件系统之间的接口
OS作为用户与计算机硬件系统之间的接口，其含义是：OS处于用户与计算机硬件系统之
间，用户通过OS来使用计算机硬件系统；或者说，用户在OS的帮助下能够方便、快捷、可靠地
操纵计算机硬件和运行自己的程序。图1-2所示为OS作为接口的示意，从图中可以看出，用户可
通过3种方式来使用计算机，即通过命令方式、系统调用方式和图形/ 窗口方式来实现自身与OS
的通信，并取得OS的服务。
用户
应用程序
系统调用　  　命令　 　图形/窗口
OS
计算机硬件
图1-2  OS作为接口的示意
2．OS 作为计算机系统资源的管理者
在一个计算机系统中，通常含有多种硬件和软件资源。归纳起来可将这些资源分为4 类：处
理机、存储器、I/O 设备以及信息（数据和程序）。相应地，OS的主要功能也正是对这4 类资源
进行有效的管理。处理机管理负责处理机的分配与控制；存储器管理负责内存的分配与回收；I/O 
设备管理负责I/O设备的分配（回收）与操纵；文件管理负责文件的存取、共享与保护等。可
见，OS的确是计算机系统资源的管理者。
值得进一步说明的是，当一台计算机系统同时供多个用户使用时，诸多用户对系统中共享
资源（包括数量和时间）的需求有可能会发生冲突。为此，OS必须对共享资源的使用请求进行
授权，以协调诸多用户对共享资源的使用。
3．OS 实现了对计算机资源的抽象
对于一个完全无软件的计算机系统（即裸机），由于它向用户提供的仅是硬件接口（物
理接口），用户必须对物理接口的实现细节有充分的了解，这致使该物理机器难以被用户方
便地使用。为了方便用户使用I/O设备，人们在裸机上覆盖了一层I/O设备管理软件（简称I/O软
件），如图1-3所示，其隐藏了I/O设备操作的细节，并可向上将I/O设备抽象为一组数据结构以
及一组I/O操作命令，如read和 write命令，这样用户即可利用这些数据结构及操作命令来进行数
据输入或输出，而无须关心 I/O是如何具体实现的。此时用户所看到的机器是一台比裸机功能更

--- Page 25 ---
4
计算机操作系统 （慕课版）
强、使用更方便的机器。换言之，在裸机上铺设的I/O软件，隐藏了I/O设备的具体细节，向上提
供了一组抽象的I/O设备。
用户
用户
I/O软件
物理接口
硬件
虚机器
机器指令
I/O操作命令
（read、write）
物理接口
硬件
图1-3  I/O软件隐藏了I/O设备操作的细节
通常把覆盖了上述软件的I/O设备称为扩充机器或虚机器。它向用户提供了一个可以对硬件
进行操作的抽象模型。用户可利用该模型提供的接口使用计算机，而无须了解物理接口的实现
细节，这使得用户可以更容易地去使用计算机硬件资源。亦即， I/O软件实现了对计算机硬件操
作的第一个层次的抽象。
同理，为了方便用户使用文件系统，又可在第一层软件（I/O软件）之上再覆盖一层用
于管理文件的软件，由它来实现对文件操作的细节，并向上层提供一组实现对文件进行存取
操作的数据结构及命令。这样，用户即可利用该软件提供的数据结构及命令来对文件进行存
取。此时用户所看到的是一台功能更强、使用更方便的虚机器。亦即，文件管理软件实现了
对硬件资源操作的第二个层次的抽象。依此类推，如果在文件管理软件之上再覆盖一层面向
用户的窗口软件，那么用户便可在窗口环境下方便地使用计算机，从而形成一台功能更强的
虚机器。
由此可知，OS是铺设在计算机硬件上的多层软件的集合，它们不仅增强了系统的功能，还
隐藏了对硬件操作的具体细节，实现了对计算机硬件操作的多个层次的抽象模型。值得说明的
是，一个硬件不仅可在低层加以抽象，还可在高层对该资源低层已抽象的模型进行再次抽象，
从而形成更高层的抽象模型。抽象层次越高，抽象接口所提供的功能就越强，用户使用起来也
就越方便。
1.1.3 推动操作系统发展的主要动力
OS自20世纪50年代诞生以来，经历了由简单到复杂、由低级到高级的发展。在短短几十年
间，OS在各方面都有了长足的进步，能够很好地适应计算机硬件和体系结构的快速发展，以及
应用需求的不断变化。下面对推动OS发展的主要动力做具体阐述。
1．不断提高计算机系统资源的利用率
在20世纪50年代，计算机系统特别昂贵，提高计算机系统中各种资源的利用率成为了OS最
初发展的推动力。由此促成了由单道批处理系统到多道批处理系统的演变，它通过减少计算机
的空闲时间提高了系统中央处理机（central processing unit，CPU）和I/O设备的利用率。
在20世纪60年代，又出现了可以支持多个用户使用一台计算机的分时系统，这使系统资源
利用率得到了极大的提高，并推动了计算机的第一次大普及。与此同时，还推出了能改善 I/O设

--- Page 26 ---
5
第
1章 
操作系统引论
备和CPU利用率的假脱机系统。
在20世纪70年代，提出了能够有效提高存储器系统利用率并能从逻辑上扩大内存的虚拟存
储器技术，其获得了广泛应用。此后在网络环境下，通过在服务器上配置网络文件系统和数据
库系统，以将资源提供给全网用户共享，这又进一步提高了资源的利用率。
2．方便用户
当资源利用率不高的问题得到基本解决后，用户在使用计算机（上机）和调试程序时的不
方便性便成为了主要矛盾。这又成为继续推动OS发展的主要因素。20世纪60年代分时系统的
出现，不仅提高了系统资源的利用率，还能实现人机交互，使用户能像早期使用计算机时一样
感觉自己独占全机资源，对其进行直接操控，同时也极大地方便了程序员对程序进行调试和修
改。在20世纪90年代初，图形用户界面的出现受到了用户的广泛欢迎，进一步方便了用户对计
算机的使用，这无疑又推动了计算机的迅速普及和广泛应用。
3．器件不断更新换代
随着信息技术（information technology， IT）的迅猛发展，尤其是微机芯片的不断更新换
代，计算机的性能得到了迅速提高，从而推动了OS的功能和性能也迅速增强和提高。例如，当
微机芯片由8位发展到16位、32位甚至64位时，相应的微机OS也就由8位OS发展到了16位、32位
甚至64位OS，此时OS相应的功能和性能都有了显著的增强和提高。
与此同时，外部设备也在迅速发展，OS所能支持的外部设备也越来越多，如现在的微机OS
已能够支持种类繁多的外部设备，除了传统的外设外，还可以支持光盘、移动硬盘、闪存、扫
描仪、数码相机等。
4．计算机体系结构不断发展
计算机体系结构的发展，不断推动着OS的发展，并产生了新的OS类型。例如，当计算机由
单处理机系统发展为多处理机系统时，相应地，OS也就由单处理机OS发展为多处理机OS。再
如，当出现了计算机网络后，配置在计算机网络上的网络OS也就应运而生了。它不仅能有效管
理好网络中的共享资源，还能向用户提供许多网络服务。
5．不断提出新的应用需求
OS发展能如此迅速的另一个重要原因是，人们不断提出新的应用需求。例如，为了提高产品
的质量和数量，需要将计算机应用于工业控制中，此时在计算机上就需要配置能进行实时控制的
OS，由此产生了实时系统。为了能满足用户在计算机上播放视频、从网上下载电影等需求，在OS
中又增添了多媒体功能。另外，用户在计算机系统中保存了越来越多的宝贵信息，致使确保系统
的安全性也成为了OS必须具备的功能。尤其是随着超大规模集成电路（very large scale integration 
circuit，VLSI）的发展，CPU体积越来越小，价格越来越便宜，大量智能设备（特别是智能手机）
应运而生，这样，嵌入式OS的产生和发展也成了一种必然。
1.2 操作系统的发展过程
20世纪50年代中期，出现了第一个简单的批处理系统。20世纪60年代中
期，开发出了多道批处理系统，不久又推出了分时系统。与此同时，用于工业 操作系统的 
类型


--- Page 27 ---
6
计算机操作系统 （慕课版）
控制和武器控制的实时系统也相继问世。20世纪70 — 90年代，是VLSI和计算机体系结构大发展
的年代，这一时期，微机、多处理机和计算机网络得以诞生并发展，相应地，也相继开发出了
微机OS、多处理机OS、网络OS和分布式OS。OS得到了极为迅速的发展。
1.2.1 未配置操作系统的计算机系统
从1945年诞生的第一台计算机，到20世纪50年代中期所出现的计算机，它们都属于第一代
计算机。此时还未出现OS，对计算机的全部操作都是由用户采取人工操作方式进行的。
1．人工操作方式
早期的操作方式是由用户将事先已穿孔的纸带（或卡片），装入纸带输入机（或卡片输入
机），再启动它们以将纸带（或卡片）上的程序和数据输入计算机，然后启动计算机运行。仅
当程序运行完毕并取走计算结果后，才允许下一个用户上机。这种人工操作方式有以下两方面
的缺点。①用户独占全机，即一台计算机的全部资源由上机用户独占。 ②CPU等待人工操作。
当用户进行装带（卡）、卸带（卡）等人工操作时，CPU及内存等资源是空闲的。可见，人工
操作方式严重降低了计算机资源的利用率，此即所谓的人机矛盾。虽然CPU的速度在迅速提
高，但I/O 设备的速度却提高缓慢，这使得CPU 与I/O设备之间速度不匹配的矛盾更加突出。为
此，曾先后出现了通道技术、缓冲技术，然而它们都未能很好地解决上述矛盾，直至后来引入
脱机I/O技术，才获得了较为令人满意的结果。
2．脱机 I/O方式
为了解决人机矛盾以及 CPU与 I/O设备之间速度不匹配的矛盾， 20世纪50年代末出现了脱
机I/O技术。该技术是事先将装有用户程序和数据的纸带装入纸带输入机，在一台外围机的控制
下，把纸带上的程序和数据输入磁带。当CPU需要这些程序和数据时，再从磁带上将它们高速
地调入内存。
类似地，当CPU需要输出时，可先由CPU把数据直接从内存高速地送到磁带上，然后在另
一台外围机的控制下，将磁带上的结果通过相应的输出设备输出。图1-4所示为脱机I/O过程示
意。由于程序和数据的输入和输出都是在外围机的控制下完成的，或者说，它们都是在脱离主
机的情况下进行的，故称其为脱机I/O方式。而把在主机的直接控制下进行I/O的方式，称为联机
I/O方式。
输入设备
外围机 磁带
主机
外围机
输出设备
图1-4  脱机I/O过程示意
这种脱机I/O方式的主要优点如下。
（1）减少了CPU的空闲时间 。装带、卸带以及将数据从低速I/O设备送到高速磁带上（或
反之）的操作，都是在脱机情况下由外围机完成的，并不占用主机时间，因此有效减少了CPU
的空闲时间。

--- Page 28 ---
7
第
1章 
操作系统引论
（2）提高了I/O速度。当CPU在运行中需要输入数据时，系统是直接从高速磁带上将数据
输入内存的，这极大地提高了I/O速度，进一步减少了CPU的空闲时间。
1.2.2 单道批处理系统
在20世纪50年代中期，出现了第二代晶体管计算机，此时计算机虽已具有推广应用的价
值，但计算机系统仍然非常昂贵。为了能充分提高计算机的利用率，应尽量保持系统连续运
行，即使其在处理完一个作业后，紧接着处理下一个作业，以减少系统的空闲时间。
1．单道批处理系统的处理过程
为了实现对作业的连续处理，需要先把一批作业以脱机I/O方式输入到磁带上，并在系统中
配上监督程序。在它的控制下，这批作业能一个接一个地被连续处理。处理过程：首先由监督
程序将磁带上的第一个作业装入内存，并把运行控制权交给该作业；当该作业处理完成时，又
把运行控制权交还给监督程序，再由监督程序把磁带上的第二个作业调入内存。计算机系统就
这样自动地、一个作业紧接一个作业地进行处理，直至磁带上的所有作业全部完成，这样便形
成了早期的批处理系统。虽然该系统对作业的处理是成批进行的，但在内存中始终只保持一道
作业，故称之为单道批处理系统。图1-5所示为单道批处理系统的处理流程。
开始 是
是
否
否
停止
是否还有
  下一个作业？
把下一个作业的
源程序转换为
目标程序
源程序
   是否有错？
运行
目标程序
装配
目标程序
图1-5  单道批处理系统的处理流程
综上所述易知，单道批处理系统是在解决人机矛盾和CPU与 I/O设备速度不匹配矛盾的过程
中形成的。换言之，单道批处理系统旨在提高系统资源的利用率和系统吞吐量。但这种单道批
处理系统仍然不能充分利用系统资源，故现已很少使用。
2．单道批处理系统的缺点
单道批处理系统最主要的缺点是，系统中的资源得不到充分利用。这是因为在内存中仅有
一道程序，每逢该程序在运行中发出I/O请求后，CPU便会处于等待状态，并且必须在该程序I/O
完成后才能继续运行。此外，I/O设备的低速性也使CPU的利用率显著降低。图1-6所示为单道程
序的运行情况，从图中可以看出，在t2～t3、t6～t7时间间隔内CPU空闲。
为了能在系统中运行较大的作业，通常在计算机中都配置了较大容量的内存，但实际情况
是有80%以上的作业都属于中小型作业，因此在单道程序环境下，也必定会造成计算机内存的
浪费。类似地，为了满足各种类型作业的需要，在系统中将会配置多种类型的 I/O设备，显然在
单道程序环境下其也不能得到充分利用。

--- Page 29 ---
8
计算机操作系统 （慕课版）
用户程序
监督程序
I/O操作
I/O中断请求 结束中断 I/O中断请求
启动I/O 启动I/OI/O完成
结束中断
I/O完成
t1 t2 t3 t4 t5 t6 t7 t8
t
图1-6  单道程序的运行情况
1.2.3 多道批处理系统
20世纪60年代中期，IBM 公司生产了第一台小规模集成电路计算机IBM 360（第三代计算
机）。它相比于晶体管计算机，在体积、功耗、速度和可靠性上都有了显著的改善，这使IBM 
360获得了极大的成功。与此同时，为它开发出了OS/360，这是第一个能运行多道程序的批处理
系统。
1．多道程序设计的基本概念
为了进一步提高资源的利用率和系统吞吐量，在20世纪60年代中期引入了多道程序设计技
术，由此形成了多道批处理系统。在该系统中，用户所提交的作业会被先存放在外存上，并排
成一个队列，称为“后备队列”。然后由作业调度程序按一定的算法从后备队列中选择若干个
作业调入内存，使它们共享CPU和系统中的各种资源。由于在内存中同时装有若干道程序，这
样便可在运行程序A时，利用其因I/O操作而暂停执行时的CPU空档时间，再调度另一道程序B运
行。同样可以利用程序B在I/O操作时的CPU空档时间，再调度程序C运行，进而实现多道程序交
替运行，这样便可以保持CPU处于忙碌状态。图1-7所示为4道程序的运行情况。
程序A
程序B
程序C
程序D
调度程序
程序A
程序B
程序C
程序D
t
程序A
I/O请求
程序A
I/O完成
程序B
I/O请求
程序C
I/O请求
程序D
I/O请求
程序C
I/O完成
程序B
I/O完成
程序A
I/O完成
程序A
再被调度
程序C
再被调度
图1-7  4道程序的运行情况
2．多道批处理系统的优缺点
① 资源利用率高 。引入多道程序机制能使多道程序交替运行，以保证CPU一直处于忙碌
状态；在内存中装入多道程序，不仅可以提高内存的利用率，还可以提高I/O设备的利用率。  
②系统吞吐量大。引入多道程序机制能提高系统吞吐量的主要原因可归结为两点：第一，CPU
和其他资源保持“忙碌”状态；第二，仅当作业完成时或运行不下去时才进行切换，系统开销  
小。③平均周转时间长。由于作业要排队并依次进行处理，因而作业的周转时间较长，通常需
要几个小时甚至几天。 ④无交互能力。用户一旦把作业提交给系统，那么直至作业完成，用户
都不能与自己的作业进行交互，这对用户修改和调试程序是极不方便的。

--- Page 30 ---
9
第
1章 
操作系统引论
3．多道批处理系统需要解决的问题
多道批处理系统是一种十分有效但又非常复杂的系统，为使系统中的多道程序间能协调地
运行，系统必须解决下述一系列问题。 ①争用处理机问题：系统既要能满足各道程序运行的需
要，又要能提高处理机的利用率。 ②内存分配与保护问题 ：系统应能为每道程序分配必要的内
存空间，以使它们“各得其所”，且不会因某道程序出现异常情况而破坏其他程序。 ③I/O设
备分配问题：系统应采取适当的策略来分配系统中的 I/O设备，以达到既能方便用户对设备的使
用，又能提高设备利用率的目的。 ④文件的组织与管理问题 ：系统应能有效地组织存放在系统
中的大量程序和数据，以使它们既便于用户使用，又能保证数据的安全性。 ⑤作业管理问题：
系统中存在着各种作业（应用程序），系统应能对系统中所有的作业进行合理的组织，以满足
这些作业对应用户的不同要求。⑥用户与系统的接口问题：为使用户能方便地使用OS，OS还应
提供用户与OS之间的接口。
为此，应在计算机系统中增加一组软件，用于对上述问题进行妥善、有效地处理。这组软
件应包括：能够有效组织和管理四大资源的软件，合理地对各类作业进行调度并控制它们所运
行的软件，以及方便用户使用计算机的软件。正是这样一组软件构成了OS。据此，我们可以将
OS定义为： OS是一组能有效地组织和管理计算机硬件和软件资源，合理地对各类作业进行调
度，以及方便用户使用的程序的集合。
1.2.4 分时系统
1．分时系统的引入
如果说，推动多道批处理系统形成和发展的主要动力是提高资源利用率和系统吞吐量，
那么，推动分时系统（time sharing system）形成和发展的主要动力，则是为了满足用户对人机
交互的需求。分时系统是在此过程中所形成的一种新型OS 。用户的需求具体表现在以下几个  
方面。
（1）人机交互 。用户每当写好一个新程序时，都需要上机进行调试。由于新编程序难免
存在一些错误或不当之处，需要进行修改，因此用户希望能像早期使用计算机时一样，独占
全机并对它进行直接控制，以便能方便地对程序中的错误进行修改。亦即，希望能进行人机
交互。
（2）共享主机。在20世纪60年代，计算机还十分昂贵，一台计算机要同时供很多用户共享
使用。显然，用户们在共享一台计算机时，每个用户都希望能像独占全机一样，不仅可以随时
与计算机进行交互，而且不会感觉到其他用户的存在。
由上所述不难得知，分时系统是指在一台主机上连接多个配有显示器和键盘的终端所形
成的系统，该系统允许多个用户同时通过自己的终端以交互方式使用计算机，并共享主机中的  
资源。
2．分时系统实现过程中的关键问题
在多道批处理系统中，用户无法与自己的作业进行交互的主要原因是：作业都先驻留在外
存中，即使以后被调入内存，也要经过较长时间的等待方能运行；在此过程中，用户无法与自
己的作业进行交互。为了实现人机交互，必须解决的关键问题是，如何使用户能与自己的作业
进行交互。为此，首先，系统必须能提供多个终端同时给多个用户使用；其次，当用户在自己
的终端上键入命令时，系统应能及时接收并处理该命令，然后将处理结果返回给用户。此后，

--- Page 31 ---
10
计算机操作系统 （慕课版）
用户可根据系统的响应情况，再继续键入下一条命令，此即人机交互。亦即，允许有多个用户
同时通过自己的键盘键入命令，系统也应能将全部命令及时接收并处理。
（1）及时接收。要做到及时接收多个用户键入的命令或数据，只须在系统中配置一个多路
卡即可。例如，如果主机上需要连接64个终端，就配置一个64用户的多路卡。多路卡的作用是
实现分时多路复用，即主机能以很快的速度周期性地扫描各个终端，并在每个终端处停留一段
很短的时间（如30ms）以接收从终端发来的数据。对于64用户的多路卡，用不到2s的时间便可
完成一次扫描，即主机可在不到2s的时间内分时接收各用户从终端上输入数据一次。此外，为
了能使从终端上输入的数据被依次逐条地进行处理，还需要为每个终端配置一个缓冲区，用于
暂存用户键入的命令或数据。
（2）及时处理。人机交互的关键在于，用户键入命令后，能对自己的作业及其运行及时地
实施控制，或进行修改。因此，各个用户的作业都必须驻留在内存中，并能频繁地获得处理机
运行。否则，用户键入的命令将无法作用到自己的作业上。由此可见，为了实现人机交互，必
须彻底改变原来批处理系统的运行方式，转而采用下面的方式。①采用作业直接进入内存的方
式。因为作业在磁盘上是不能运行的，所以其应直接进入内存。②采用轮转运行的方式。如果
一个作业独占处理机而连续运行，那么其他作业就没有机会被调度运行。为避免一个作业长期
独占处理机，引入了时间片的概念。一个时间片就是一段很短的时间，如30ms。系统规定每个
作业每次只能运行一个时间片，然后就暂停该作业的运行，并立即调度下一个作业运行。如果
在不长的时间内能使所有的作业都执行一个时间片的时间，则可使每个用户都能及时地与自己
的作业进行交互，从而可使用户的请求得到及时响应。
3．分时系统的特征
分时系统与多道批处理系统相比，具有不同的、非常明显的特性，可以将其归纳成以下  
4点。
（1）多路性，是指系统允许将多台终端同时联接到一台主机上，并按分时原则为每个用户
服务。多路性允许多个用户共享一台计算机，这显著地提高了资源利用率，降低了使用费用，
从而促进了计算机更广泛的应用。
（2）独立性，是指系统提供了一种用机环境，即每个用户在各自的终端上进行操作，彼此
之间互不干扰，给用户的感觉就像是他一人独占主机。
（3）及时性，是指用户的请求能在很短的时间内获得响应。这一时间间隔是根据人们所能
接受的等待时间确定的，通常仅为1～3s。
（4）交互性，是指用户可以通过终端与系统进行广泛的人机对话。其广泛性表现在：用户
可以请求系统提供多方面的服务，如进行文件编辑和数据处理、访问系统中的文件系统和数据
库系统、打印运行结果等。
1.2.5 实时系统
所谓“实时”，是指“及时”；而“实时计算”，则可以定义为这样一类计算：系统的正
确性不仅由计算的逻辑结果来确定，而且还取决于产生结果的时间。事实上，实时系统（real 
time system）最主要的特征是将时间作为关键参数，它必须对所接收的某些信号做出“及时”或
“实时”的反应。由此得知，实时系统是指系统能及时响应外部事件的请求，在规定的时间内
完成对该事件的处理，并控制所有实时任务协调一致地运行。

--- Page 32 ---
11
第
1章 
操作系统引论
1．实时系统的类型
随着计算机应用的普及，实时系统的类型也相应增多。下面列出了当前常见的几种实时  
系统。
（1）工业控制系统 。当计算机被用于生产过程的控制，形成以计算机为中心的控制系
统时，该系统应具有能实时采集现场数据，并对所采集的数据进行及时处理，进而能够自动
控制相应的执行机构，使之具有按预定的规律变化的功能，以确保产品的质量和产量。类似
地，也可将计算机用于对武器的控制，如火炮的自动控制系统、飞机的自动驾驶系统以及导
弹的制导系统等。
（2）信息查询系统。该系统接收用户从远程终端上发来的服务请求，根据用户发来的请求
对信息进行检索和处理，并能及时对用户做出正确的回答。具体的信息处理系统有飞机或火车
的订票系统等。
（3）多媒体系统。随着计算机硬件和软件的快速发展，文本、图像、音频和视频等信息已
能被集成在一个文件中，进而形成一个多媒体文件。例如，在使用光盘播放器所播放的数字电
影中，就包含了音频、视频和横向滚动的文字等信息。为了保证好的视觉和听觉感受，用于播
放视频和音频的多媒体系统必须是实时信息处理系统。
（4）嵌入式系统。随着集成电路的发展，已制作出各种类型的芯片，可将这些芯片嵌入各
种仪器和设备中，用于对设备进行控制或对其中的信息进行处理，这样就构成了所谓的智能仪
器和智能设备。此时还须为其配置上嵌入式OS，它同样需要具有实时控制或处理功能。
2．实时任务的类型
（1）周期性实时任务和非周期性实时任务 。周期性实时任务是指这样一类任务：外部设
备周期性地发出激励信号给计算机，要求它按指定周期循环执行，以便周期性地控制某外部设
备。反之，非周期性实时任务并无明显的周期性，但都必须联系着一个截止时间（deadline ），
或称为最后期限，其可分为两种。①开始截止时间：指某任务在某时刻以前必须开始执行；  
②完成截止时间：指某任务在某时刻以前必须执行完成。
（2）硬实时任务和软实时任务。硬实时（hard real time， HRT）任务是指系统必须满足任
务对截止时间的要求，否则可能出现难以预测的后果。用于工业控制和武器控制的实时系统，
通常执行的就是HRT任务。软实时（soft real time， SRT）任务也联系着一个截止时间，但并不
严格，若偶尔错过了任务的截止时间，则其对系统产生的影响也不会太大。例如，信息查询系
统和多媒体系统中的实时任务，通常就是SRT任务。
3．实时系统与分时系统特征的比较
（1）多路性。信息查询系统和分时系统中的多路性都表现为，系统按分时原则为多个终端
用户服务；实时控制系统的多路性则是，系统周期性地对多路现场信息进行采集，并对多个对
象或多个执行机构进行控制。
（2）独立性。信息查询系统中的每个终端用户在与系统进行交互时，彼此相互独立、互不
干扰；同样在实时控制系统中，对信息的采集和对对象的控制，也都是彼此互不干扰的。
（3）及时性。信息查询系统对实时性的要求是依据人所能接受的等待时间确定的。多媒体
系统实时性的要求是播放出来的音频和视频能令人满意。实时控制系统的实时性则是以控制对
象所要求的截止时间来确定的，一般为秒级到毫秒级。
（4）交互性 。在信息查询系统中，人与系统的交互性仅限于访问系统中某些特定的专

--- Page 33 ---
12
计算机操作系统 （慕课版）
用服务程序。它并不能像分时系统那样向终端用户提供数据处理、资源共享等服务。多媒体
系统的交互性也仅限于由用户发送某些特定的命令，如开始、停止、快进等，然后由系统立
即响应。
（5）可靠性。分时系统要求系统可靠，实时系统要求系统高度可靠，因为任何差错都可能
会带来无法预料的灾难性后果。因此，在实时系统中，往往都采取了多级容错措施，以保障系
统及数据的安全性。
1.2.6 微机操作系统
随着VLSI和计算机体系结构的发展，以及应用需求的不断扩大，OS仍然在继续发展。由此先
后形成了微机OS、嵌入式OS、网络OS、分布式OS等。本小节将具体介绍微机OS的发展与分类。
配置在微机上的OS称为微机OS，由于使用者通常为个人，因此其也被称为个人计算机
（personal computer）。最早诞生的微机OS是配置在8 位微机上的CP/M。后来出现了16位微机，
相应地，16位微机OS也应运而生；当微机发展为 32位、64位时，32位和64位的微机OS也应运
而生。可见，微机OS可按微机的字长来分，这里所说的字长是指CPU一次能够处理的二进制位
数，例如，16位字长是指CPU一次能够并行处理16个二进制位。
此外，微机OS也可按运行方式来分。现在流行的微机OS按运行方式可分为以下几类。
1．单用户单任务 OS
单用户单任务OS的含义是，只允许一个用户上机，且只允许用户程序作为一个任务运行。
这是最简单的微机OS，主要配置在8 位和16位微机上。最有代表性的单用户单任务OS是 CP/M
（8位）和MS-DOS（16位）。
2．单用户多任务 OS
单用户多任务OS的含义是，只允许一个用户上机，但允许用户把程序分为若干个任务并发
执行，从而有效地改善了系统性能。早期在32位微机上配置的OS基本上都是单用户多任务OS。
最有代表性的单用户多任务 OS是由微软公司推出的 Windows系列，如 Windows 3.1 、Windows 
95/98等。
3．多用户多任务 OS
多用户多任务OS的含义是，允许多个用户通过各自的终端使用同一台机器，共享主机系统中
的各种资源，而每个用户程序又可进一步分为几个任务，使它们能并发执行，从而可进一步提高
资源利用率和系统吞吐量。在大、中、小型计算机中所配置的系统大多是多用户多任务OS，而在
当前的32位、64位微机上，也有不少配置了多用户多任务OS。最具代表性的多用户多任务OS是
UNIX系统、各种类UNIX系统（如Solaris、Linux等）以及Windows NT/Server系列的系统。
多用户多任务OS除了具有界面友好、管理方便和适于普及等优点外，还具有支持多用户使
用、可移植性良好、功能强大、通信能力强等优点。
1.2.7 嵌入式操作系统
1．嵌入式系统
与通用的计算机（如便携式计算机或桌面系统等）不同，嵌入式系统（embedded system）
是为了完成某个特定功能而设计的系统，或是具有附加机制的系统，或是其他部分的计算机硬

--- Page 34 ---
13
第
1章 
操作系统引论
件与软件的结合体。在许多情况下，嵌入式系统都是一个大系统或产品中的一部分，如汽车中
的防抱死系统。
嵌入式系统的数量远超过普通的OS，而且应用非常广泛。这些系统的需求和限制有着很
大的不同。同时，嵌入式系统通常与它们所处的环境紧密地联系在一起。由于与环境交互的需
要，从而产生了实时限制。这类限制（如响应速度、测量精度、持续时间等）决定了软件操作
的时限。需要说明的是，如果多个活动必须进行同步管理，则需要更复杂的实时限制。
2．嵌入式 OS
嵌入式OS是指应用于嵌入式系统的OS。嵌入式OS是一种用途广泛的系统软件，通常包括
与硬件相关的低层驱动软件、系统内核、设备驱动接口、通信协议、图形用户界面、标准化浏
览器等。嵌入式OS负责嵌入式系统的全部软硬件资源的分配、任务的调度以及并发活动的协调
等。它必须体现其所在系统的特征，必须能够通过装卸某些模块来实现系统所要求的功能。
目前在嵌入式领域广泛使用的OS有嵌入式（实时）µC/OS-II、嵌入式Linux、 Windows 
Embedded、VxWorks，以及应用在智能手机和平板电脑上的Android、iOS等。
3．嵌入式 OS 的特点
由于嵌入式系统对存储空间、功耗和实时性等有特定的要求，因此嵌入式OS 也具有独特的
特性，介绍如下。
（1）系统内核小 。由于嵌入式OS一般应用于小型电子装置，系统资源相对有限，因此其
内核较传统OS要小得多。
（2）系统精简。嵌入式OS一般没有系统软件和应用软件的明显区分，不要求功能设计与
实现过于复杂。这样既可以控制系统成本，也有利于系统安全。
（3）实时性高。实时性高是嵌入式软件的基本要求，此外，软件还要求固态存储以提高速
度，软件代码要求高质量和高可靠性。
（4）具有可配置性 。由于嵌入式系统的多样性，一个嵌入式OS若想应用在不同的嵌入式
系统中，它就必须可以灵活配置，以便为特定的应用和硬件系统提供所需的功能。
1.2.8 网络操作系统
网络OS是用于在计算机网络环境下对网络资源进行管理和控制，实现数据通信及对网络
资源的共享，为用户提供网络资源接口的一组软件和规程的集合。网络OS 建立在网络中的计
算机各自不同的单处理机OS之上，为用户提供使用网络资源的桥梁。常见的局域网上的OS有
UNIX、Linux、Windows NT/2000/Server等。
1．网络 OS 的特征
一般而言，网络OS具有以下5个特征。
（1）硬件独立性 ：系统可以运行于各种硬件平台之上，例如，可以运行于 Intel 80x86系
统，也可以运行于面向精简指令集计算机（reduced instruction set computing，RISC）的系统，如
DEC Alpha、MIPS R4000等。
（2）接口一致性：系统为网络中的共享资源提供一致性的接口，即针对同一性质的资源，
采用统一的访问方式和接口。
（3）资源透明性：系统能对网络中的资源进行统一管理，能够根据用户的要求对资源进行

--- Page 35 ---
14
计算机操作系统 （慕课版）
自动选择和分配。
（4）系统可靠性 ：系统利用资源在地理上分散的优点，通过统一的管理、分配和调度手
段，确保了整个网络的安全可靠。如果一个节点和通信链路出现故障，则可屏蔽该节点或重新
定义新的通信链路，以保证网络的正常运行。
（5）执行并行性：系统不仅实现了在每个节点计算机中各道进程的并发执行，而且实现了
网络中多个节点计算机上进程的并行执行。
2．网络 OS 的功能
网络OS不仅涵盖了单处理机OS的全部功能，还具有支持数据通信、应用互操作、网络管理
等功能。
为了实现网络中计算机之间的数据通信，网络OS 应具有如下基本功能：①连接的建立与拆
除；②报文的分解与组装；③传输控制；④流量控制；⑤差错的检测与纠正。为了实现多个网
络之间的通信和资源共享，不仅需要将它们从物理上连接在一起，还需要使不同网络中的计算
机系统之间能进行通信（信息互通）和实现资源共享（信息互用）。为此，在网络OS中必须提
供应用互操作功能，以实现“信息互通性”及“信息互用性”。在网络中引入网络管理功能，
可以确保最大限度地增加网络的可用时间、提高网络设备的利用率、改善网络的服务质量以及
保障网络的安全性等。
1.2.9 分布式操作系统
1．分布式系统
分布式系统（distributed system），是基于软件实现的一种多处理机系统，是多个处理机
通过通信线路互联而构成的松散耦合系统，系统的处理和控制功能分布在各个处理机上。换言
之，分布式系统是利用软件系统方式构建在计算机网络上的一种多处理机系统。
与传统的多处理机系统（包括多处理机和多计算机等）相比，分布式系统的不同之处在
于：①分布式系统中的每个节点都是一台独立的计算机，并配置有完整的外部设备；②分布式
系统中节点的耦合程度更低，地理分布区域更加广阔；③分布式系统中的每个节点均可以运行
不同的OS，每个节点均拥有自己的文件系统，除了本节点的管理外，还有其他多个机构会对其
实施管理。
针对分布式系统，已有很多不同的定义。例如：分布式系统是一些独立的计算机的集合，
但是对这个系统的用户来说，系统就像一台计算机一样。再如：分布式系统是能为用户自动管
理资源的网络OS，它能调用用于完成用户任务所需要的资源，而整个网络就像一个大的计算机
系统一样对用户是透明的。归纳起来，分布式系统应具有以下几个主要特征。
（1）分布性 ：分布式系统由多台计算机组成，从位置和地域范围来看，它们是分散的和
广阔的，此即地理位置的分布性。从系统的功能来看，功能分散在系统的各个节点计算机上，
此即功能的分布性。从系统的资源来看，资源也分散配置在各节点计算机上，此即资源的分布
性。从系统的控制来看，在一般的分布式系统中，计算机没有主从之分，此即控制的分布性。
其中，资源和控制的分布性也称为自治性。
（2）透明性：分布式系统的系统资源被所有计算机共享。每台计算机的用户不仅可以使用
本机的资源，还可以使用分布式系统中其他计算机的资源，包括CPU、文件、打印机等。
（3）同一性：分布式系统中的若干台计算机可以通过互相协作来完成同一任务，或者说一

--- Page 36 ---
15
第
1章 
操作系统引论
个程序可以分布在几台计算机上并行地运行。
（4）全局性：系统具备一个全局性的进程通信机制，系统中的任意两台计算机都可以通过
该机制实现信息交换。
2．分布式 OS
分布式OS是配置在分布式系统上的公用OS，其以全局的方式对分布式系统中的所有资源
进行统一管理，可以直接对系统中地理位置分散的各种物理和逻辑资源进行动态分配和调度，
有效地协调和控制各个任务的并行执行，协调和保持系统内的各个计算机间的信息传输与协作
运行，并向用户提供一个统一的、方便的、透明的使用系统界面和标准接口。一个典型的例子
是万维网（world wide web， WWW），在万维网中，所有的操作只通过一种界面（即网页）进
行。目前，华为所研发的鸿蒙系统（HarmonyOS）就是一个“面向未来”、面向全场景（包括
移动办公、运动健康、社交通信、媒体娱乐等）的分布式OS。它在传统的单一设备系统能力的
基础上，增加了支持多种终端设备的功能。
与网络OS不同，分布式OS的用户在使用系统资源时，不需要了解诸如网络中各个计算机的
功能与配置、OS的差异、软件资源、网络文件的结构、网络设备的地址、远程访问的方式等情
况，即系统对用户屏蔽了其内部实现的细节。分布式OS保持了网络OS所拥有的全部功能，同时
又具有透明性、内聚性、可靠性和高性能等特点。
分布式OS除了涵盖单处理机OS的主要功能外，还应该包括以下功能。
①通信管理功能。分布式OS应提供某种通信机制和方法，使不同节点上的用户或进程能方
便地进行信息交换。一般地，分布式OS通过提供一些通信原语的方式，实现了系统内的进程通
信，但由于系统中没有共享内存，这些原语需要按照通信协议的约定和规则来实现。
②资源管理功能 。分布式OS对系统中的所有资源实施统一管理、统一分配和统一调度，
以提高资源利用率，方便用户共享和使用。例如，提供不同节点用户均可共享的分布式文件系
统、分布式数据库系统、分布式程序设计语言及编译系统、分布式邮件系统等。
③进程管理功能。针对系统的分布性特征，为了平衡各节点负载，加速计算速度，分布式
OS应提供进程或计算迁移功能；为了协调进程对资源的共享与竞争，提高进程的并行程度，分
布式OS还应提供分布式的同步和互斥机制以及应对死锁的措施等。
1.3 操作系统的基本特性
前面所介绍的几种OS都具有各自不同的特征，例如，批处理系统有着高的资源利用率和系
统吞吐量，分时系统能获得及时响应，实时系统具有实时特征。除此之外，它们还共同具有并
发、共享、虚拟和异步这4个基本特性。
1.3.1 并发
正是系统中的程序能并发（concurrence ）执行，才使得OS能有效地提高系统中资源的利用
率，增加系统的吞吐量。
1．并行与并发
并行与并发，是既相似又有区别的两个概念。 并行是指两个或多个事件在同一时刻发生，
而并发是指两个或多个事件在同一时间间隔内发生。在多道程序环境下， 并发是指在一段时

--- Page 37 ---
16
计算机操作系统 （慕课版）
间内宏观上有多个程序在同时运行；但在单处理机系统中，每一时刻仅能有一道程序执行，
故在微观上这些程序只能分时交替执行。例如，在60ms的时间内，0ms ～15ms，程序A 执行；
16ms ～30ms，程序B 执行；31ms ～45ms，程序C 执行；46ms ～60ms，程序D 执行。因此可以
说，在60ms的时间间隔内，宏观上有四道程序在同时运行，但微观上，程序A 、B、C、D是分
时交替执行的。
倘若在计算机系统中有多个处理机，那么这些能并发执行的程序，便可被分配到多个处理机上
实现并行执行，即利用每个处理机来处理一个可并发执行的程序。这样，多个程序便可同时执行。
2．引入进程
在一个未引入进程的系统中，同属于一个应用程序的计算程序和I/O程序只能顺序执行，即
只有在计算程序的执行告一段落后才允许I/O程序执行；换言之，在执行I/O程序时，计算程序也
不能执行。但在为计算程序和I/O程序分别建立一个进程（process）后，这两个进程便可并发执
行。若对内存中的多个程序都分别建立一个进程，则它们就可以并发执行，这样便能极大限度
地提高系统资源的利用率，以及增加系统的吞吐量。
所谓进程，是指在系统中能独立运行并能作为资源分配对象的基本单位，它是由一组机器
指令、数据和堆栈等组成的，是一个能独立运行的活动实体。多个进程之间可以并发执行和交
换信息。事实上，进程和并发是现代OS中最重要的基本概念，也是OS运行的基础，因此，本书
将在第2章中对其做详细介绍。
1.3.2 共享
一般情况下的资源共享（sharing）与OS环境下的资源共享，含义并不完全相同。前者只是
说明某种资源能被大家使用，例如，图书馆中的图书能提供给大家阅读，但并未限定借阅者必
须在同一时间（间隔）和同一地点进行阅读；再如，学校里的计算机机房供全校学生上机，或
者说，全校学生共享该机房中的计算机设备，虽然所有班级的上机地点是相同的，但各班的上
机时间并不相同。对于这样的资源共享方式，仅须通过适当的安排，用户之间便不会产生对资
源的竞争，因此资源管理是比较简单的。
而在OS环境下的资源共享，或称为资源复用，是指系统中的资源可供内存中多个并发执行
的进程共同使用。这里在宏观上既限定了时间（进程在内存中时），又限定了地点（内存）。
对于这种资源共享方式，其管理就要复杂得多，因为系统中的资源远少于多道程序需求的总
和，这就会造成它们对共享资源的争夺。因此，系统必须对共享资源进行妥善管理。由于资源
属性的不同，进程对资源复用的方式也不同，目前实现资源共享的主要方式有如下两种。
1．互斥共享方式
系统中的某些资源，如打印机、磁带机等，虽然可以提供给多个进程（线程）使用，但应
规定在一段时间内只允许一个进程访问该资源。为此，在系统中应建立一种机制，以保证多个
进程对这类资源进行互斥访问。
当进程A要访问某资源时，必须先提出请求。若此时该资源空闲，系统便可将其分配给进
程A使用。此后若再有其他进程也要访问该资源，则只要进程A 未用完，其他进程就必须等待。
仅当进程A访问完并释放后，才允许另一进程对该资源进行访问。这种资源共享方式称为互斥式
共享，我们把这种在一段时间内只允许一个进程访问的资源，称为临界资源（或独占资源）。
系统中的大多数物理设备以及栈、变量和表格等，都属于临界资源，都只能被互斥地共享。为

--- Page 38 ---
17
第
1章 
操作系统引论
此，在系统中必须配置某种机制，以保证各进程互斥地使用临界资源。
2．同时共享方式
系统中还有一类资源，允许在一段时间内由多个进程“同时”对它们进行访问。这里所说
的“同时”，在单处理机环境下是宏观意义上的；而在微观上，这些进程对该资源的访问是交
替进行的。典型的可供多个进程“同时”访问的资源是磁盘设备。一些用可重入代码编写的文
件也可以被“同时”共享，即允许若干个用户同时访问该文件。
并发和共享是多用户（多任务）OS的两个最基本的特征。它们互为对方存在的条件，即
一方面，资源共享是以进程的并发执行为条件的，若系统不允许并发执行，也就不存在资源共
享问题；另一方面，若系统不能对资源共享实施有效的管理，以协调好各进程对共享资源的访
问，则必然会影响各进程间并发执行的程度，甚至会使它们根本无法并发执行。
1.3.3 虚拟
用于实现“虚拟”（virtual）的技术最早出现在通信系统中。在早期，每条物理信道只能供
一对用户通话，为了提高通信信道的利用率而引入了“虚拟”技术。该技术通过“空分复用”
或“时分复用”技术，将一条物理信道分为若干条逻辑信道，使原来只能供一对用户通话的物
理信道，变为能供多对用户同时通话的逻辑信道。
在OS中，把通过某种技术将一个物理实体变为若干个逻辑上的对应物的功能，称为“虚  
拟”。前者是实的，即实际存在的；后者是虚的，是用户感觉存在的东西。相应地，把用于实
现虚拟的技术称为虚拟技术。在OS中也是利用时分复用和空分复用技术来实现“虚拟”的。
1．时分复用技术
在计算机领域中，广泛利用时分复用技术来实现虚拟处理机、虚拟设备等，以提高资源的
利用率。时分复用技术能提高资源利用率的根本原因在于，它会令某设备在为一个用户服务的
空闲时间转去为其他用户服务，进而使设备得到最充分的利用。
（1）虚拟处理机技术。利用多道程序设计技术，为每道程序建立至少一个进程，使多道程
序并发执行。此时，虽然系统中只有一台处理机，但通过时分复用技术能实现（宏观上）同时
为多个用户服务，使每个终端用户都认为有一个处理机在专门为他服务。亦即，利用多道程序
设计技术，可将一台物理上的处理机虚拟为多台逻辑上的处理机，然后可在每台逻辑处理机上
运行一道程序。我们把用户所感觉到的处理机称为虚拟处理机。
（2）虚拟设备技术 。我们还可以利用时分复用技术，将一台物理上的I/O设备虚拟为多台
逻辑上的I/O设备，并允许每个用户占用一台逻辑上的I/O设备。这样便可使原来仅允许在一段时
间内由一个用户访问的设备（即临界资源），变为允许多个用户“同时”访问的共享设备，即
其在宏观上能“同时”为多个用户服务。例如，原来的打印机属于临界资源，而通过虚拟设备
技术可以把它变为多台逻辑上的打印机，供多个用户“同时”进行打印操作。关于虚拟设备技
术，本书将在第7章中对其进行详细介绍。
2．空分复用技术
20世纪初，电信业中就已使用频分复用技术来提高信道的利用率。它是将一个频率范围比
较宽的信道划分成多个频率范围较窄的信道（称为频带），其中任何一个频带都仅供一对用户
通话。早期的频分复用技术只能将一条物理信道划分为几条到几十条话路，后来很快发展到能

--- Page 39 ---
18
计算机操作系统 （慕课版）
划分为成千上万条话路，每条话路供一对用户通话。再后来，在计算机中也把空分复用技术用
于对存储空间进行管理，以提高存储空间的利用率。
如果说多道程序技术（时分复用技术）是利用处理机的空闲时间来运行其他程序以提高处
理机的利用率的，那么，空分复用技术就是利用存储器的空闲空间（如某道程序阻塞时被换出
到外存而空出来的内存空间）来存放其他程序以提高内存的利用率的。
但是，单纯的空分复用存储器只能提高内存的利用率，并不能实现在逻辑上扩大存储器容
量这一功能，因此还必须引入虚拟存储技术才能达到此目的。虚拟存储技术在本质上是实现内
存的分时复用，即它可以通过分时复用内存的方式，使一道程序仅在远小于它的内存空间中运
行。例如，一个100MB的用户程序之所以可以运行在30MB的内存空间，实质上是因为每次只
把用户程序的一部分调入内存运行，运行完成后就将该部分换出，再换入另一部分到内存中运
行，通过这样的置换功能便实现了用户程序的各个部分“分时地”进入内存运行。
应当着重指出：虚拟的实现，如果是采用时分复用技术，即对某一物理设备进行分时使
用，设N是某物理设备所对应的虚拟的逻辑设备数，则每台虚拟设备的平均速度必然等于或小于
物理设备速度的1/N。类似地，如果是采用空分复用技术，则此时一台虚拟设备平均占用的空间
必然也等于或小于物理设备所拥有空间的1/N。
1.3.4 异步
在多道程序环境下，系统允许多个进程并发执行。在单处理机环境下，由于系统中只有一
台处理机，因此每次只允许一个进程执行，其余进程只能等待。当正在执行的进程提出某种资
源请求，如打印请求，而打印机又正在被其他进程占用时，由于打印机属于临界资源，因此正
在执行的进程必须等待并释放处理机，直到打印机空闲并再次获得处理机时，该进程方能继续
执行。可见，由于资源等因素的限制，进程的执行通常不可能“一气呵成”，而是会以“停停
走走”的方式运行。
对于内存中的每个进程，其在何时能获得处理机并运行，何时又因提出某种资源请求而暂
停，以及进程以怎样的速度向前推进，每道程序总共需要多少时间才能完成等，都是不可预知
的。由于各用户程序的性能不同，例如，有的程序侧重于计算而较少需要 I/O，而有的程序则计
算少而I/O多，这样，很可能是先进入内存的作业后完成，而后进入内存的作业先完成。换言
之，进程是以人们不可预知的速度向前推进的，此即进程的异步性（ asynchronism ）。尽管如
此，倘若在OS中配置完善的进程同步机制，且运行环境相同，则作业即便经过多次运行，也都
会获得完全相同的结果的。因此，异步运行方式是被允许的，而且是OS的一个重要特征。
1.4 操作系统的运行环境
1.4.1 硬件支持
OS与运行该OS的计算机硬件联系密切。OS扩展了计算机指令集并管理着计算机的资源。
为了能够工作，OS 必须了解大量硬件，至少需要了解硬件如何“面对”程序员。出于这一原
因，这里简要介绍现代个人计算机中的计算机硬件。
现代通用计算机系统包括一个或多个CPU和若干个设备控制器，通过公用总线相连而成，
该总线提供了共享内存的访问功能。每个设备控制器负责一类特定的设备，如磁盘驱动器、音
频设备或视频显示器等。CPU与设备控制器可以并发执行，但会竞争访问共享内存。为了确保

--- Page 40 ---
19
第
1章 
操作系统引论
访问共享内存的有序性，需要内存控制器来协调它们对内存的访问。
当打开计算机电源或重启计算机以便开始运行时，计算机需要运行一个初始程序或引导程
序（bootstrap program）。该引导程序通常很简单，一般位于计算机的固件（firmware）中，
如只读存储器（read-only memory， ROM）或电擦除可编程只读存储器（electrically-erasable 
programmable read-only memory， EEPROM）等。它会初始化系统的各个组件（如CPU寄存器、
设备控制器等）以及内存内容。引导程序必须知道如何加载OS并开始执行系统。为了实现这一
目标，引导程序必须定位OS内核并将其加载到内存中。
所谓OS的内核（kernel ），是指OS一直运行在计算机上的程序。除了内核外，还有其他两
类程序：系统程序和应用程序。前者是与系统运行有关的程序，但不是内核的一部分；后者是
与系统运行无关的所有其他程序。OS内核的介绍具体参见1.4.2小节。
一旦内核被加载到内存中并执行，它就会开始为系统与用户提供服务。除了内核外，系统程
序也提供了一些服务，它们在启动时会被加载到内存而成为系统进程或系统后台程序，其生命周
期与内核一样。对于UNIX系统，首个系统进程为“init”，它启动了许多其他的系统后台程序。
一旦这个阶段完成，系统就完全启动了，并且会等待事件发生。事件发生通常会通过硬件或软件
中断来通知，OS会一直这样运行到系统关机。本书将在1.4.4小节和7.3节中对中断进行具体介绍。
CPU只能从内存中加载指令，因此要执行的程序必须位于内存。通用计算机运行的大多数程
序通常位于可读写内存，也称为随机存取存储器（random access memory，RAM）。内存通常为动
态随机存取存储器（dynamic random access memory，DRAM），它采用半导体技术来实现。当然
计算机也会采用其他形式的内存，如ROM或EEPROM等。所有形式的内存都提供字节数据，每个
字节都有地址。CPU会通过一系列load或store内存指令来对指定的内存地址进行操作。
除内存外，计算机系统还具有其他存储设备，整个系统的存储结构将在第5 章中进行介绍。
另外，系统还会配备大容量的、非易失的外存设备，如磁盘、磁带等，以存储程序和数据。大
多数程序（系统程序与应用程序）都保存在磁盘上，当要执行时才会将它们加载到内存中。因
此，磁盘存储管理是否适当对计算机系统来说十分重要，这将在第9章中进行讨论。
OS的大部分代码专用于I/O管理，这是因为它对系统性能的提升至关重要，也是因为不同设
备具有不同的特性。具体的I/O设备及其管理将在第7章中进行讨论。
1.4.2 操作系统内核
现代OS一般会划分为若干层次，再将不同功能分别设置在不同层次中。通常将一些与硬件
紧密相关的模块（如中断处理程序等）、各种常用设备的驱动程序、运行频率较高的模块（如
时钟管理模块、进程调度模块等）以及许多模块所公用的一些基本操作，都安排在紧靠硬件的
软件层次中，并将它们常驻内存。它们通常被称为OS内核。这种安排方式的目的在于：一是便
于对这些软件进行保护，防止它们遭受其他应用程序的破坏；二是可以提高OS的运行效率。
总体而言，不同类型和规模的OS ，它们的内核所包含的功能间存在着一定的差异，但大多
数OS内核都包含了以下两类功能。
1．支撑功能
该类功能主要实现提供给OS 其他众多模块所需要的一些基本功能，以支撑这些模块工作。
其中3种最基本的支撑功能是：中断处理、时钟管理和原语操作。
（1）中断处理 。中断处理是内核最基本的功能，是整个OS赖以活动的基础，OS中许多
重要的活动，如各种类型的系统调用、键盘命令的输入、进程调度、设备驱动等，无不依赖于

--- Page 41 ---
20
计算机操作系统 （慕课版）
中断。通常，为减少处理机中断的时间，提高程序执行的并发性，内核在对中断进行“有限处
理”后便会转入相关的进程，由这些进程继续完成后续的处理工作。
（2）时钟管理。时钟管理是内核的一项基本功能，在OS中的许多活动都需要得到它的支
撑，如在时间片轮转调度中，每当时间片用完时，便会由时钟管理产生一个中断信号，促使调
度程序重新进行调度。同样，在实时系统中的截止时间控制、批处理系统中最长运行时间的控
制等，也无不依赖于时钟管理功能。
（3）原语操作。所谓原语（primitive），就是由若干条指令组成的，用于完成一定功能的
一个过程。它与一般过程的区别在于：它们是“原子操作”（action operation）。所谓原子操
作，是指一个操作中的所有动作要么全做、要么全不做，此即原子性。换言之，它是一个不可
分割的基本单位。因此，原语在执行过程中不允许被中断。原子操作在内核态下执行，常驻内
存。在内核中可能有许多原语，如用于对链表进行操作的原语、用于实现进程同步的原语等。
2．资源管理功能
（1）进程管理。在进程管理中，或者由于各个功能模块（如进程的调度与分派、进程的创
建与撤销等）的运行频率较高，或者由于它们为多种原语操作（如用于实现进程同步的原语操  
作、常用的进程通信原语操作等）所需要，通常将它们放在内核中，以提高OS的性能。
（2）存储器管理。存储器管理软件的运行频率也比较高，如用于实现将用户空间的逻辑地
址变换为内存空间的物理地址的地址变换机构，用于内存分配与回收的模块，以及用于实现内
存保护和对换功能的模块等，通常都放在内核中，以保证存储器管理具有较高的运行速度。
（3）设备管理。由于设备管理与硬件（设备）紧密相关，因此其中很大部分也都设置在内
核中，如各类设备的驱动程序、用于缓和 CPU与I/O设备速度不匹配矛盾的缓冲管理模块、用于
实现设备分配与设备独立性功能的模块等。
1.4.3 处理机的双重工作模式
为了确保OS正确运行，必须区分OS代码和用户代码的执行。大多数计算机系统采用硬件支
持，以便区分代码的执行模式。
一般地，处理机至少需要两种单独运行模式：用户态（user mode）和内核态（kernel 
mode）。用户态也称为目态，内核态也称为管态或系统态。计算机硬件可以通过一个模式位  
（mode bit）来表示当前模式：内核态（0）和用户态（1）。有了模式位，就可以区分为OS所执
行的任务和为用户所执行的任务。当计算机系统执行用户程序时，系统处于用户态。然而，当
用户程序通过系统调用（详见1.7节）请求OS服务时，系统必须从用户态切换到内核态，以满足
请求，如图1-8所示。这种切换方式也可用于OS的许多其他方面。
用户程序
内核
陷入
模式位=0
返回
模式位=1
执行用户程序 调用系统调用 从系统调用返回
执行系统调用
用户态
（模式位=1）
内核态
（模式位=0）
图1-8  用户态到内核态的切换
处理机的双重
工作模式


--- Page 42 ---
21
第
1章 
操作系统引论
当存在系统引导时，硬件会从内核态开始工作，OS接着加载，然后在用户态下执行用户程序。
一旦有中断或陷阱，硬件就会从用户态切换到内核态（即将模式位置0）。因此，每当OS能够控制计
算机时，它就处于内核态。在将控制权交给用户程序前，系统会切换到用户态（将模式位置1）。
双重模式执行提供了保护手段，以防止OS 和用户程序受到错误用户程序的影响。这种保护
可通过如下方式实现：将可能引起损害的机器指令当作特权指令（privileged instruction），硬件
只有在内核态下才允许执行特权指令；其他指令为非特权指令（non-privileged instruction）。具
体说明如下。
（1）特权指令 ，是指在内核态下运行的指令，它对内存空间的访问范围基本不受限制。
它不仅能访问用户空间，还能访问系统空间，如执行启动外部设备、设置系统时钟时间、关中
断、切换执行状态等操作。切换到用户态的指令也是特权指令。
（2）非特权指令，是指在用户态下运行的指令。应用程序所使用的都是非特权指令，它只
能完成一般性的操作和任务，不能对系统中的硬件和软件进行直接访问，对内存的访问范围也
局限于用户空间。这样，可以防止应用程序的运行异常对系统造成破坏。
这种限制是由硬件实现的，如果在应用程序中使用了特权指令，则硬件并不会执行该指
令，而是会认为该指令非法，并发出权限出错信号，OS在捕获到这个信号后，将会转入相应的
错误处理程序，以停止该应用程序的运行，并重新进行程序调度。
1.4.4 中断与异常
现代OS是中断驱动（interrupt driven）的。如果没有进程需要执行，没有I/O设备需要服务，没有
用户需要响应，那么OS就会静静地等待某个事件发生。事件总是由中断（interrupt）或陷阱（trap）
引起的。陷阱（或异常）是一种由软件引起的中断，或源于出错（如除数为零或无效存储访问
等），或源于用户程序的特定请求（如执行OS的某个服务等）。OS的这种中断特性规定了系统的
通用结构。对于每一种中断，OS都会通过不同的代码来处理它。中断处理程序用于处理中断。
中断是硬件通过系统总线发送信号到CPU来触发的。当CPU被中断时，它会停止正在做的
事，并立即转到固定位置再继续执行。该固定位置通常包含中断处理程序的开始地址。中断处
理程序开始执行并在执行完后，CPU会重新执行被中断的计算。
中断是计算机体系结构的重要组成部分。虽然每个计算机都设计有各自的中断机制，但是
它们的有些功能是相同的。中断应将控制转移到合适的中断处理程序，实现这一转移的直接方
法是，调用一个通用程序以检查中断信息，接着，该程序会调用特定的中断处理程序。不过，
中断处理应当快捷。由于只有少量预定义的中断，因此可以通过中断处理程序的指针表来间接
调用中断处理程序，而无须通过其他中介程序。通常，指针表位于低地址内存（地址为100左
右的位置），其中包含各种设备的中断处理程序的地址。这种地址被称为中断向量（interrupt 
vector）。对于任一给定的中断请求，可通过唯一的设备号来索引，进而为其提供设备的中断处
理程序的地址。许多不同的OS（如Windows系统和UNIX系统）都采用这种方式来处理中断。本
书在7.3节中将会更加详细地描述中断。
1.5 操作系统的主要功能
引入OS的主要目的是，为多道程序的运行提供良好的运行环境，以保证多道程序能有条不
紊地、高效地运行，并能最大限度地提高系统中各种资源的利用率和方便用户的使用。为此，

--- Page 43 ---
22
计算机操作系统 （慕课版）
传统OS中应具有处理机管理、存储器管理、设备管理和文件管理等基本功能。此外，为了方便
用户使用OS，还须向用户提供方便的用户接口。
1.5.1 处理机管理功能
在传统的多道程序系统中，处理机的分配和运行都以进程为基本单位，因而对处理机的管
理可归结为对进程的管理。处理机管理的主要功能有：创建和撤销进程，对各进程的运行进行
协调，实现进程之间的信息交换，以及按照一定的算法把处理机分配给进程。
1．进程控制
在多道程序环境下，为使作业能并发执行，必须为每道作业创建一个或几个进程，并为之
分配必要的资源。当进程运行结束时，应立即撤销该进程，以便能及时回收该进程所占用的各
类资源，供其他进程使用。在设置有线程的OS中，进程控制还应包括为一个进程创建若干个线
程，以提高系统的并发性。因此，进程控制的主要功能是：为作业创建进程，撤销（终止）已
结束的进程，以及控制进程在运行过程中的状态转换。
2．进程同步
为使多个进程能有条不紊地运行，系统中必须设置相应的进程同步机制。该机制的主要任
务是对多个进程（含线程）的运行进行协调。有两种协调方式：①进程互斥方式，这是指各进
程在对临界资源进行访问时，应采用互斥方式；②进程同步方式，这是指在相互合作以完成共
同任务的各进程间，由同步机构对它们的执行次序加以协调。最简单的用于实现进程互斥的机
制是，为每个临界资源配置一把锁，当锁打开时，进程可以对该临界资源进行访问；而当锁关
上时，禁止进程访问该临界资源。在实现进程同步时，最常用的机制是信号量机制。
3．进程通信
当有一组相互合作的进程在完成一个共同的任务时，在它们之间往往需要交换信息。例
如，有3个相互合作的进程，即输入进程、计算进程和打印进程；其中，输入进程负责将所输入
的数据传送给计算进程；计算进程利用输入的数据进行计算，并把计算结果传送给打印进程；
最后由打印进程把计算结果打印出来。进程通信的任务是实现相互合作进程之间的信息交换。
当相互合作的进程处于同一计算机系统时，在它们之间通常会采用直接通信方式，即由源
进程利用发送命令，直接将消息（message）挂到目标进程的消息队列上，以后由目标进程利用
接收命令从其消息队列中取出消息。
4．调度
在传统OS中，调度包括作业调度和进程调度两步。 ①作业调度：作业调度的基本任务是按
照一定的算法，从后备队列中选出若干个作业，并为它们分配运行所需的资源；在将这些作业
调入内存后，分别为它们建立进程，以使它们都成为可能会获得处理机的就绪进程，并将这些
进程插入就绪队列。 ②进程调度：进程调度的任务是按照一定的算法，从进程的就绪队列中选
出一个进程，将处理机分配给它，并为它设置运行现场，使其投入执行。
1.5.2 存储器管理功能
存储器管理的主要任务是，为多道程序的运行提供良好的环境、提高存储器的利用率、方

--- Page 44 ---
23
第
1章 
操作系统引论
便用户使用，并能从逻辑上扩大内存。为此，存储器管理应实现内存分配和回收、内存保护、
地址映射和内存扩充等功能。
1．内存分配和回收
内存分配的主要任务是：①为每道程序分配内存空间，使它们“各得其所”；②提高存储
器的利用率，尽量减少不可用的内存空间（内部碎片）；③允许正在运行的程序申请附加的内
存空间，以适应程序和数据动态增长的需要。
OS在实现内存分配时，可采取静态和动态两种分配方式。 ①静态分配方式：每个作业的内
存空间是在作业装入时确定的，在作业装入后的整个运行期间，不允许该作业再申请新的内存
空间，也不允许该作业在内存中“移动”。 ②动态分配方式：每个作业所要求的基本内存空间
虽然也是在装入时确定的，但允许作业在运行过程中继续申请新的附加内存空间，以适应程序
和数据的动态增长，也允许作业在内存中“移动”。
内存属于有限资源。随着系统的运行，内存会被逐渐消耗。因此，当程序执行完毕后，需
要将其所占用的内存及时回收再分配，以提高系统内存资源的利用率。内存回收的任务就是回
收程序所占用的内存，并根据当前的内存管理算法将回收的内存经过处理放入对应的管理数据
结构中，供下次分配时使用。
2．内存保护
内存保护的主要任务是：①确保每道用户程序都仅在自己的内存空间中运行，彼此互不干
扰；②绝不允许用户程序访问OS的程序和数据，也不允许其转移到非共享的其他用户程序中去
执行。
为了确保每道程序都只在自己的内存空间中运行，必须设置内存保护机制。一种比较简单
的内存保护机制是：设置两个界限寄存器，分别用于存放正在执行程序的上界和下界。在程序
运行时，系统须对每条指令所要访问的地址进行检查，如果发生越界，则发出越界中断请求，
以停止该程序的执行。
3．地址映射
在多道程序环境下，由于每道程序经编译和链接后所形成的可装入程序，其地址都是从0
开始的，而又不可能将它们从内存的“0”地址（物理）开始装入，因此（各程序段的）地址空
间内的逻辑地址与其在内存空间中的物理地址并不一致。为保证程序能正确运行，存储器管理
必须提供地址映射功能，即能够将地址空间中的逻辑地址变换为内存空间中与之对应的物理地
址。该功能应在硬件的支持下实现。
4．内存扩充
内存扩充并非是指从物理上去扩大内存容量，而是借助虚拟存储技术，从逻辑上去扩大
内存容量，使用户感觉到的内存容量比实际内存容量大得多，以便让更多的用户程序能并发运
行。这样既满足了用户的需要，又改善了系统的性能。
为了能在逻辑上扩大内存，系统必须设置内存扩充机制（包含少量的硬件），用于实现下
述功能。①请求调入功能：系统允许在仅装入部分用户程序和数据的情况下，便能启动该程序
运行；在程序运行过程中，若发现继续运行所需的程序和数据尚未装入内存，则可向OS发出请
求，由OS从磁盘中将所需部分调入内存，以使程序能够继续运行。 ②置换功能：若发现在内存
中已无足够的空间来装入需要调入的程序和数据时，则系统应能将内存中的一部分暂时不用的

--- Page 45 ---
24
计算机操作系统 （慕课版）
程序和数据调至盘上，以腾出内存空间，然后再将所须调入的部分装入内存。
1.5.3 设备管理功能
设备管理的主要任务是：①完成用户进程提出的I/O请求，为用户进程分配所需的I/O设备，
并完成指定的I/O操作；②提高CPU 和I/O设备的利用率，提高I/O速度，方便用户使用I/O设备。
为完成上述任务，设备管理应实现缓冲管理、设备分配和设备处理等功能。
1．缓冲管理
如果在I/O设备和CPU之间引入缓冲，则可有效地缓和CPU与 I/O设备速度不匹配的矛盾，
提高CPU的利用率，进而提高系统吞吐量。因此在现代OS中，无一例外地在内存中设置了缓
冲区，而且还可通过增加缓冲区容量的方法来改善系统的性能。不同的系统可采用不同的缓冲
区机制。最常见的缓冲区机制有：①单缓冲区机制；②能实现双向同时传送数据的双缓冲区机
制；③能供多个设备同时使用的公用缓冲池机制。上述这些缓冲区机制所对应的缓冲区都会由
OS缓冲管理机制进行管理。
2．设备分配
设备分配的基本任务是，根据用户进程的I/O请求与系统现有资源情况，按照某种设备分配
策略，为之分配其所需的设备。如果在I/O设备和CPU之间还存在着设备控制器和I/O通道，则还
须为分配出去的设备分配相应的设备控制器和通道。为了实现设备分配，系统中应设置设备控
制表、控制器控制表等数据结构，用于记录设备及设备控制器等的标识符和状态。根据这些表
可以了解指定设备当前是否可用、是否忙碌，以供系统进行设备分配时参考。在进行设备分配
时，应针对不同的设备类型而采用不同的设备分配方式。对于独占设备的分配，还应考虑该设
备被分配出去后系统是否安全。在设备使用完后，应立即由系统将其回收。
3．设备处理
设备处理程序又称为设备驱动程序，其基本任务是实现CPU和设备控制器之间的通信，即
由CPU向设备控制器发出I/O命令，要求它完成指定的I/O操作；以及由CPU接收从设备控制器发
来的中断请求，并给予迅速的响应和相应的处理。
设备处理过程：首先检查I/O请求的合法性，了解设备是否处于空闲状态，读取相关的传
递参数并设置设备的工作方式；然后向设备控制器发出I/O命令，启动I/O设备去完成指定的I/O  
操作。此外设备驱动程序还应能及时响应由设备控制器发来的中断请求，并根据该中断请求的
类型，调用相应的中断处理程序进行处理。对于设置了通道的计算机系统，设备处理程序还应
能根据用户的I/O请求自动地构成通道程序。
1.5.4 文件管理功能
文件管理的主要任务是对用户文件和系统文件进行管理以方便用户使用，并保证文件的安
全性。为此，文件管理应实现文件存储空间管理、目录管理、文件的读/写管理和保护等功能。
1．文件存储空间管理
在多用户环境下，由用户自己对文件的存储进行管理，这不仅非常困难，而且十分低效。
因而需要由文件系统对诸多文件及文件的存储空间实施统一的管理。其主要任务是：为每个文

--- Page 46 ---
25
第
1章 
操作系统引论
件分配必要的外存空间、提高外存的利用率，这也有助于提高文件系统的存取速度。为此，系
统中应设置相应的数据结构，用于记录文件存储空间的使用情况，以供分配存储空间时参考；
系统还应具有对存储空间进行分配和回收的功能。
2．目录管理
目录管理的主要任务是为每个文件建立一个目录项，目录项包括文件名、文件属性、文件
在磁盘上的物理位置等，并对众多的目录项加以有效的组织，以实现方便的按名存取（用户只
须提供文件名，即可对该文件进行存取）。目录管理还应能实现文件共享，且在实现时，只须
在外存上保留一份该共享文件的副本即可。此外，目录管理还应能提供快速的目录查询手段，
以提高对文件的检索速度。
3．文件的读 / 写管理和保护
（1）文件的读/写管理 。该功能是根据用户的请求从外存中读取数据，或将数据写入外
存。在进行文件读（写）时，系统先根据用户给出的文件名去检索文件目录，从中获得文件在
外存中的位置；然后，利用文件读（写）指针对文件进行读（写）操作，一旦读（写）完成，
便修改读（写）指针，为下一次读（写）做好准备。读操作和写操作由于不会同时进行，故可
合用一个读/写指针。
（2）文件保护 。为了防止系统中的文件被非法窃取和破坏，在文件系统中必须提供有效
的存取控制功能，以实现下述目标：①防止未经核准的用户存取文件；②防止冒名顶替存取文
件；③防止以不正确的方式使用文件。
1.5.5 接口管理功能
为了方便用户对OS的使用，OS向用户提供了“用户与OS之间的接口”。该接口通常可分
为以下两类。
1．用户接口
为了便于用户直接或间接地控制自己的作业，OS 向用户提供了用户接口。用户可通过该接
口向作业发出命令以控制作业的运行。该接口又可进一步分为3 种：联机用户接口、脱机用户接
口和图形用户接口。
（1）联机用户接口。该接口通常也被称为命令行方式（command-line interface，CLI），是
为联机用户提供的，它由一组键盘操作命令及命令解释程序组成。当用户在终端或控制台上键
入一条命令后，系统便会立即转入命令解释程序，对该命令加以解释并执行。在完成指定操作
后，“控制”又会返回到终端或控制台上，等待用户键入下一条命令。这样，用户就可以通过
先后键入不同命令的方式来实现对作业的控制，直至作业完成。
（2）脱机用户接口。该接口即批命令方式，是为批处理作业的用户提供的。用户使用作业
控制语言（job control language ，JCL）把需要对作业进行的控制和干预的命令，事先写在作业
说明书上，然后将它与作业连在一起提供给系统。当系统调度到该作业运行时，是通过调用命
令解释程序去对作业说明书上的命令逐条进行解释执行的，直至遇到作业结束语句时，系统才
会停止该作业的运行。
（3）图形用户接口（graphics user interface，GUI）。通过联机用户接口来取得OS的服务，
既不方便、又花时间，用户须熟记所有命令及其格式和参数，并须逐个字符地键入命令，在此

--- Page 47 ---
26
计算机操作系统 （慕课版）
背景下，图形用户接口应运而生。图形用户接口采用了图形化的操作界面，采用非常容易识别
的各种图标来将系统的各项功能、各种应用程序和文件直观、逼真地表示出来。用户可以通过
菜单（和对话框），用移动鼠标选择菜单项的方式取代命令的键入，这样可以方便、快捷地完
成对应用程序和文件的操作，从而把用户从烦琐且单调的操作中解脱出来。
2．程序接口
该接口是为用户程序在执行中访问系统资源而设置的，是用户程序取得OS服务的唯一途
径。它是由一组系统调用组成的，每个系统调用都是一个能完成特定功能的子程序。每当应用
程序要求OS提供某种服务（功能）时，便调用具有相应功能的系统调用。早期的系统调用都是
用汇编语言编写的，只有在用汇编语言编写的程序中，才能直接使用系统调用。但在高级语言
以及C语言中，往往提供了与各系统调用一一对应的库函数，这样，应用程序便可通过调用对应
的库函数来使用系统调用。但在近几年所推出的OS（如OS/2等）中，系统调用本身已经采用C
语言编写，并以函数形式提供，故在用C 语言编写的程序中可直接使用系统调用。本书在1.7节
中将会更加详细地描述系统调用。
为什么 CLI 不常运行于内核中？用户有没有可能通过使用由 OS 提供的程序接口实现一个
新的 CLI ？
思考题
1.5.6 现代操作系统的新功能
现代OS是在传统OS的基础上发展起来的，它除了具有传统OS的功能外，还增加了保障系
统安全、支持用户通过联网获取服务和可处理多媒体信息等功能。
1．保障系统安全
通常，政府机关和企事业单位有大量重要的信息，它们必须被高度集中地存储在计算机系
统中。因此，如何确保在计算机系统中存储和传输数据的保密性、完整性和系统安全性，便成
了计算机系统亟待解决的重要问题；而保障系统安全的任务，也责无旁贷地落到了现代OS的  
身上。
虽然在传统OS中也采取了一些保障系统安全的措施，但随着计算机技术的进步和网络
的普及，传统的安全措施已远不能满足要求。为此，在现代OS中采取了多种有效措施来确
保系统的安全。这里仅介绍保障系统安全的几个技术问题。 ①认证技术 ，是一个用来确认被
认证的对象是否名副其实的过程，即用来确定对象的真实性，以防止入侵者进行假冒与篡改
等。例如，身份认证，即通过验证被认证对象的一个或多个参数的真实性和有效性来确定被
认证对象是否名副其实的。因此，在被认证对象与要验证的那些参数之间，应存在严格的对
应关系。 ②密码技术 ，对系统中所须存储和传输的数据进行加密，使之成为密文；这样，攻
击者即使截获了数据，也无法了解数据的内容。只有指定的用户才能对该数据加以解密，进
而了解其内容。因此，该技术有效地保护了系统中信息资源的安全性。近年来，国内外广泛
应用数据加密技术，以保障计算机系统的安全性。 ③访问控制技术 ，可通过两种途径来保障
系统中资源的安全：一是通过对用户存取权限的设置，可以限定用户只能访问被允许访问的
资源，这样也就限定了用户对系统资源的访问范围；二是通过对文件属性的设置，可以保障

--- Page 48 ---
27
第
1章 
操作系统引论
指定文件的安全性，例如，设置文件属性为“只读”后，该文件就只能被读而不能被修改。
④反病毒技术 ，对于病毒（特指计算机病毒）的威胁，最好的解决方法是预防，即不让病毒
侵入系统，但要完全做到这一点是十分困难的，因此还需要非常有效的反病毒软件来检测病
毒。在反病毒软件被安装到计算机上后，其便可对硬盘上所有的可执行文件进行扫描，以检
查硬盘上的所有可执行文件，若发现有病毒，则立即将其清除。
2．支持用户通过联网获取服务
在现代OS中，为支持用户联网以取得网络所提供的各类服务，如电子邮件服务、Web 服务
等，应在OS中增加面向网络的功能，用于实现网络通信和资源管理，以及提供用户取得网络服
务的手段。作为一个网络OS，其应当具备多方面的功能，包括： ①网络通信，用于在源主机和
目标主机之间实现无差错的数据传输，如通信链路建立与拆除、传输控制、差错控制和流量控
制等；②资源管理，对网络中的共享资源（硬件和软件）实施有效的管理，以协调各用户对共
享资源的使用，保证数据的安全性和一致性，典型的共享硬件资源有硬盘、打印机等，共享软
件资源有文件、数据等； ③应用互操作，在一个由若干个不同网络互联所构成的互联网络中，
必须提供应用互操作功能，以实现信息的互通性和信息的互用性。信息的互通性，是指在处于
不同网络中的用户之间能实现信息的互通。信息的互用性，是指用户可以访问不同网络中的文
件系统和数据库系统中的信息。
3．可处理多媒体信息
一个支持多媒体的OS，必须能像一般OS处理文字、图形信息那样去处理音频和视频信息等
多媒体信息。为此，OS还增加了处理多媒体信息的功能： ①接纳控制功能，在多媒体系统中，
为了保证同时运行多个实时进程的截止时间，需要对系统中运行的SRT 任务数目、驻留在内存
中的SRT任务数目加以限制，为此设置了相应的接纳控制功能，如媒体服务器的接纳控制、存
储器接纳控制和进程接纳控制等； ②实时调度，多媒体系统中的SRT 任务往往都是一些要求较
严格的、周期性的SRT 任务，例如为了保证动态图像的连续性，图像的更新周期必须在40ms 之
内，因此在进行SRT任务调度时，不仅需要考虑进程调度的策略，还需要考虑进程调度的接纳度
等，相比传统OS要复杂得多；③存储多媒体文件，为了实现该功能，对OS所提出的最重要的要
求是，能把硬盘上的数据快速地传送到输出设备上，因此，对传统文件系统中数据的离散存放
方式和磁盘寻道方式都要加以改进。
在 OS 的各个功能中，请思考哪个功能最为重要？为什么？
思考题
1.6 操作系统的结构
早期OS的规模很小，如只有几十KB，完全可以由一个人以手工方式用几
个月的时间编制出来。此时，编制程序基本上是一种技巧，OS是否有结构并
不那么重要，重要的是程序员的程序设计技巧。但随着OS 规模的愈来愈大，
其所具有的代码也愈来愈多，往往需要由数十人、数百人甚至更多的人参与，
通过分工合作来共同完成其设计。这意味着，应采用工程化的开发方法来对大
型软件进行开发，由此产生了“软件工程学”。
操作系统结构


--- Page 49 ---
28
计算机操作系统 （慕课版）
软件工程学研究的目标是十分明确的，所开发的软件产品应具有良好的软件质量与合理的开
发费用。整个费用应能为用户所接受；软件质量可用这样几个指标来评价：功能性、有效性、可
靠性、易用性、易维护性和易移植性。为此，先后产生了多种OS开发方法，如模块化方法、结构
化方法和面向对象的方法等。利用不同的开发方法，所开发出的OS将具有不同的结构。
1.6.1 简单结构
在早期开发OS时，设计者只把他的注意力放在了功能的实现和获得更高的效率上，而缺乏
首尾一致的设计思想。此时的OS是为数众多的一组过程的集合，每个过程均可任意地调用其他
过程，这致使OS内部既复杂、又混乱。因此，这种OS是无结构的，也有人把它称为整体系统结
构或简单结构。
此时，程序设计的技巧仅在于如何编写紧凑的程序，以便于有效地利用内存。当系统不
太大时，在一个人能够完全理解和掌握的情况下，设计出的OS所存在的问题还不是太大；
但随着系统的不断扩大，所设计出的OS就会变得既庞大、又杂乱。这一方面会使所编写的
程序错误很多，给调试工作带来很多困难；另一方面会使程序难以阅读和理解，增加了维护
人员的负担。
简单结构 OS的一个典型例子是 MS-DOS系统。该系统并没有很好地区分功能的接口和层
次。例如，应用程序能访问基本的I/O程序，并能将数据直接写到显示器和磁盘。这种自由度
使MS-DOS系统易受错误（或恶意）程序的伤害，进而可能会导致整个系统崩溃。当然， MS-
DOS系统还受限于当时的硬件，其所用的Intel 8088微处理机未能提供双模式和硬件保护功能，
因此，设计人员除了允许应用程序访问基础硬件外，没有其他选择。
1.6.2 模块化结构
1．模块化程序设计技术的基本概念
模块化程序设计技术，是20世纪60年代出现的一种结构化程序设计技术。该技术基于“分
解”和“模块化”原则来控制大型软件的复杂度。为使OS具有较清晰的结构，不再将众多的过程
直接构成OS，而是将OS按其功能精细地划分为若干个具有一定独立性和大小的模块。每个模块
具有某方面的管理功能，如进程管理、存储器管理、文件管理等，并仔细地规定好各模块间的接
口，使各模块之间能通过该接口实现交互。然后进一步将各模块细分为若干个具有一定功能的子
模块，如把进程管理模块分为进程控制、进程调度等子模块，各子模块之间的接口同样也要规定
好。若子模块较大，则可将其再进一步细分。我们把这种设计方法称为模块-接口法，由此构成的
OS就是具有模块化结构的OS。图1-9所示为由模块、子模块等构成的具有模块化结构的OS。
OS
进程管理
进程控制子模块
模块
进程调度 内存分配 内存保护 磁盘管理 目录管理
存储器管理 文件管理…… ……
……
图1-9  具有模块化结构的OS

--- Page 50 ---
29
第
1章 
操作系统引论
2．模块独立性
在采用模块-接口法设计OS结构时，关键问题是模块的划分和规定好模块之间的接口。如
果在划分模块时将模块划分得太小，则虽然可以降低模块本身的复杂性，但也会导致模块之间
的联系过多，进而导致系统比较混乱；如果将模块划分得过大，则又会增加模块内部的复杂
性。因此在划分模块时，应在“两者”之间进行权衡。
另外，在划分模块时，必须充分注意模块的独立性问题，因为模块独立性越高，各模块间
的交互就越少，系统的结构也就越清晰。衡量模块的独立性有以下两个标准：①内聚性，指模
块内部各部分间联系的紧密程度，内聚性越高，模块独立性越强；②耦合度，指模块间相互联
系和相互影响的程度，显然，耦合度越低，模块独立性越强。
3．模块 - 接口法的优缺点
利用模块 -接口法开发的OS，较无结构OS具有以下显著优点：①提高了OS设计的正确  
性、可理解性和易维护性；②增强了OS的可适应性；③加速了OS的开发过程。
模块化结构设计仍存在下述问题：①在设计OS时，对各模块间接口的规定，很难满足
划分完成后模块对接口的实际需求；②在OS设计阶段，设计者必须做出一系列的决定（决
策），每个决定必须建立在上一个决定的基础上，但在模块化结构设计中，各模块的设计齐
头并进，无法寻找一个可靠的决定顺序，进而造成了各种决定的“无序性”，这将使程序员
很难做到“设计中的每一步决定”都是建立在可靠的基础上的，因此模块 -接口法又被称为
“无序模块法”。
目前，设计OS的常用方法是采用可加载的内核模块（loadable kernel module）。这里，
内核有一组核心组件，无论在启动时还是在运行时，内核都可以通过模块链入额外服务。这
种类型的设计常见于现代UNIX系统（如Solaris、 Linux或 Mac OS X等）以及Windows系统
的实现过程中。这种设计的思想是：内核提供核心服务，而其他服务可在内核运行时动态实
现。动态链接服务优于直接添加新功能到内核，这是因为对于每次更改，后者都需要重新编
译内核。
1.6.3 分层式结构
1．分层式结构的基本概念
为了将模块-接口法中“决定顺序”的无序性变为有序性，引入了有序分层法。有序分层法
的设计任务是，在目标系统A n和裸机系统（又称宿主系统）A 0之间，铺设若干个层次的软件A 1, 
A2, …, An-1，使An通过An-1, An-2, …, A2，A1层软件，最终能在A0上运行。在OS中，常采用自底向
上分层设计法来铺设这些中间层软件。
自底向上分层设计法的基本原则是：每一步设计都是建立在可靠的基础上的。为此规定，
每一层仅能使用其低层所提供的功能和服务，这样可使系统的调试和验证都变得更容易。例
如，在调试第一层软件A 1时，由于它使用的是一个完全确定的物理机器（宿主系统）所提供的
功能，在对A1层软件经过精心设计和几乎是穷尽无遗的测试后，可以认为A 1是正确的，而且它
与其所有的高层软件A 2, A3, …, An无关；同样在调试第二层软件A 2时，它也只使用了A 1层软件
和物理机器所提供的功能，而与其高层软件A 3, A4, …, An无关，如此一层一层地自底向上增添
软件层，每层都实现若干功能，最后总能构成一个可以满足用户需要的OS。在用这种方法构成

--- Page 51 ---
30
计算机操作系统 （慕课版）
OS时，已将一个OS分为若干个层次，每层又由若干个模块组成，各层之间只存在单向的依赖关
系，即高层仅依赖于紧邻它的低层。
2．分层式结构的优缺点
分层式结构的主要 优点有：①易保证系统的正确性，自下而上的设计方式，使所有设计
中的决定都是有序的，或者说是建立在较为可靠基础上的，这样比较容易保证整个系统的正确
性；②可保证系统的易维护性和可扩充性，若想在系统中增加、修改或替换一个层次中的模块
或整个层次，则只要不改变相应层次间的接口，就不会影响其他层次，这必将使系统维护和扩
充变得更加容易。
分层式结构的主要 缺点是系统效率较低。由于分层式结构是分层单向依赖的，必须在各层
之间都建立层间的通信机制，OS每执行一个功能，通常要自上而下地穿越多个层次，这无疑会
增加系统的通信开销，从而导致系统效率降低。
1.6.4 微内核结构
OS的微内核（microkernel）结构，是20世纪80年代后期发展起来的。由于它能有效地支持
多处理机运行，故非常适用于分布式系统环境。当前比较流行的、能支持多处理机运行的OS，
几乎全部都采用了微内核结构，例如卡内基梅隆大学研制的Mach OS，便属于微内核结构的
OS；再如Windows 2000/XP系统，也采用了微内核结构。
1．微内核 OS 的基本概念
为了提高OS的“正确性”“灵活性”“易维护性”和”可扩充性”，在进行现代OS结构设
计时，即使在单处理机环境下，也大都会采用基于客户/ 服务器模式的微内核结构，将OS划分为
两大部分：微内核和多个服务器。至于什么是微内核结构，现在尚无公认的定义，但可以从以
下4个方面对微内核结构的OS进行描述。
（1）足够小的内核。
在微内核结构的OS中，内核是指精心设计的、能实现现代OS最基本核心功能的小型内核，
微内核并不是一个完整的OS，而只是OS中最基本的部分，它通常包含：①用于处理与硬件紧密
相关的部分；②一些最基本的功能；③客户和服务器之间的通信。它们只是为构建通用OS提供
了一个重要基础。这样就可以确保把OS内核做得很小。
（2）基于客户/服务器模式。
由于客户/服务器模式具有非常多的优点，故在单处理机微内核结构的OS中几乎无一例外地
都采用了客户/ 服务器模式，将OS中最基本的部分放入内核中，而把OS的绝大部分功能都放在
微内核外面的一组服务器（进程）中实现，例如，用于提供进程（线程）管理功能的进程（线
程）服务器、提供虚拟存储器管理功能的虚拟存储器服务器、提供I/O设备管理功能的I/O设备服
务器等，都是被作为进程来实现的，它们运行在用户态。客户与服务器之间是借助微内核提供
的消息传递机制来实现信息交互的。图1-10所示为单处理机环境下的客户/服务器模式。
客户
进程
客户
进程
进程
服务器
I/O设备
服务器
请求 核心 回答
用户方式
核心方式
文件
服务器
虚拟存储器
服务器……
图1-10  单处理机环境下的客户/服务器模式

--- Page 52 ---
31
第
1章 
操作系统引论
（3）采用策略与机制分离原则。
在现代OS的结构设计中，经常会采用策略与机制分离原则来构造OS结构。所谓机制，是指
实现某一功能的具体执行机构；而策略，则是指在机制的基础上，借助于某些参数和算法来实
现该功能的优化或达到不同的功能目标。通常，机制处于系统的基层，而策略则处于系统的高
层。在传统OS中，将机制放在OS内核的较低层，将策略放在OS 内核的较高层。而在微内核OS
中，通常将机制放在OS的微内核中。正因为如此，才有可能将内核做得很小。
（4）采用面向对象技术。
OS是一个极其复杂的大型软件系统，我们不仅可以通过结构设计来降低OS的复杂度，还
可以基于面向对象技术中的“抽象”和“隐蔽”原则控制系统的复杂性，再进一步利用“对
象”“封装”“继承”等概念来确保OS的“正确性”“可靠性”“易修改性”“易扩展性”
等，并提高OS的设计速度。正因面向对象技术能带来如此多的好处，所以面向对象技术被广泛
应用于现代OS的设计中。
2．微内核的基本功能
微内核应具有哪些功能，或者说哪些功能应放在微内核中，哪些功能应放在微内核外，目
前尚无明确的规定。现在通常采用策略与机制分离原则，将机制部分以及与硬件紧密相关的部
分放入微内核中。由此可知，微内核通常具有以下几个方面的功能。
（1）进程（线程）管理。
大多数的微内核OS，对于进程管理功能的实现，都采用策略与机制分离原则。例如，为实
现进程（线程）调度功能，须在进程管理中设置一个或多个进程（线程）优先级队列，以将指
定优先级进程（线程）从所在队列中取出，并将其投入执行。由于这一部分属于调度功能的机
制部分，故应将它放入微内核中。如何确定各类用户（进程）的优先级，又应如何确定每类用
户中各用户的优先级等问题，都属于策略问题，可将它们放入微内核外的进程（线程）管理服
务器中，以完成上述“确定”任务。
由于进程（线程）之间的通信功能是微内核OS最基本的功能，会被频繁使用，因此几乎所
有的微内核OS都将进程（线程）之间的通信功能放入微内核中。此外，还将进程的切换、线程
的调度以及多处理机之间的同步等功能也放入微内核中。
（2）低级存储器管理。
通常在微内核中，只配置最基本的低级存储器管理机制，例如，用于实现将用户空间的逻
辑地址变换为内存空间的物理地址的页表机制和地址变换机制，这一部分是依赖于机器的，因
此放入微内核中。而实现虚拟存储器管理的策略，包含应采用何种页面置换算法、采用何种内
存分配与回收策略等，则应放在微内核外的存储器管理服务器中。
（3）中断和陷入处理。
大多数微内核OS都将与硬件紧密相关的一小部分放入微内核中进行处理，此时微内核的主
要功能是捕获所发生的中断和陷入事件，并进行相应的前期处理，如进行中断现场保护、识别
中断或陷入事件的类型等，然后将有关事件的信息转换成消息，并把它发送给相关的服务器；
由服务器根据中断或陷入事件的类型，调用相应的处理程序来进行后期处理。
在微内核OS中，将进程管理、存储器管理、I/O管理等功能一分为二，并将其中属于机制
的、很小的一部分放入微内核中，另外的绝大部分放在微内核外的各种服务器中。事实上，微
内核外的大多数服务器都要比微内核大。这进一步说明了为什么能在采用客户/ 服务器模式后，
还能把微内核做得很小的原因。

--- Page 53 ---
32
计算机操作系统 （慕课版）
3．微内核 OS 的优点
由于微内核结构是建立在模块化、层次化结构的基础上的，并采用了客户/ 服务器模式和
面向对象的程序设计技术，因此，微内核结构的OS是集各种技术优点之大成。现将其优点细述  
如下。
（1）提高了系统可扩展性。
由于微内核OS的许多功能是由相对独立的服务器软件来实现的，当开发了新的硬件和软件
时，微内核OS只须在相应的服务器中增加新的功能，或再增加一个专门的服务器即可。与此同
时，微内核结构也必然会改善系统的灵活性，因为不仅可在OS中增加新的功能，还可修改原有
功能，以及删除已过时的老功能，进而形成一个更为精干的、有效的OS。
（2）增强了系统的可靠性。
一方面，微内核是经过精心设计和严格测试的，这容易保证其正确性；另一方面，微内核
提供了规范而精简的应用程序接口（application programming interface， API），这为在微内核外
部编写高质量的程序创造了条件。此外，由于所有服务器都运行在用户态，服务器与服务器之
间采用的是消息传递通信机制，因此，某个服务器出现错误不会影响微内核，也不会影响其他
服务器。
（3）增强了系统的可移植性。
随着硬件的快速发展，出现了各种各样的硬件平台，作为一个好的OS，必须具备可移植
性，以使自身能够较容易地运行在不同的计算机硬件平台上。在微内核结构的OS中，所有与特
定CPU和I/O设备有关的代码，均放在微内核和微内核下面的硬件隐藏层中，而OS的其他绝大部
分组件（各种服务器）均与硬件平台无关，因而，把OS从一个计算机硬件平台移植到另一个计
算机硬件平台上所须做的修改是比较小的。
（4）提供了对分布式系统的支持。
在微内核OS中，由于客户和服务器之间、服务器和服务器之间的通信，均采用消息传递通
信机制实现，微内核OS能很好地支持分布式系统和网络系统。事实上，只要在分布式系统中赋
予所有进程和服务器唯一的标识符，在微内核中再配置一张系统映射表（即进程和服务器的标
识符与它们所驻留的机器之间的对应表），在进行客户与服务器通信时，只须在所发送的消息
中标上发送进程和接收进程的标识符，微内核便可利用系统映射表将消息发往“目标”，而无
论“目标”驻留在哪台机器上。
（5）融入了面向对象技术。
在设计微内核OS时，采用了面向对象技术，其中的“封装”“继承”“对象类”和“多
态性”，以及在对象之间采用消息传递机制等，都十分有利于提高系统的“正确性”“可靠
性”“易修改性”“易扩展性”等，而且还能显著减少开发系统的开销。
4．微内核 OS 存在的问题
应当指出，在微内核OS中，由于采用了非常小的内核，客户/服务器模式和消息传递机制，
虽给微内核OS带来了许多优点，但也使微内核OS存在着缺点，其中最主要的缺点是相比于早期
的OS，微内核OS的运行效率有所降低。
效率降低最主要的原因是，在完成一次客户对OS 提出的服务请求时，需要利用消息实现多
次交互，以及进行用户/内核模式和上下文的多次切换。然而，在早期的OS中，用户进程在请求
取得OS服务时，一般只须进行两次上下文的切换：一次是在执行系统调用后，由用户态转向内
核态时；另一次是在系统完成用户请求的服务后，由内核态返回用户态时。

--- Page 54 ---
33
第
1章 
操作系统引论
在微内核OS中，客户和服务器、服务器和服务器之间的通信都须通过微内核，这使得同样
的服务请求至少需要进行4 次上下文切换。第1 次发生在客户发送请求消息给微内核，以请求取
得某服务器特定的服务时；第2 次发生在由微内核把客户的请求消息发往服务器时；第3 次发生
在服务器完成客户的请求后，把响应消息发送到微内核时；第4 次发生在微内核将响应消息发送
给客户时。
实际情况往往还会引起更多的上下文切换。例如，当某个服务器自身尚无能力完成客户请
求而需要其他服务器帮助时，如图1-11所示，其中的文件服务器需要磁盘设备服务器的帮助，
这时就需要进行8次上下文的切换。
客户机应用
返回
微内核
（a）在传统OS中的上下文切换
（b）在微内核OS中的上下文切换
OS内核
客户机应用 文件服务器 磁盘设备驱动器
图1-11  在传统OS和微内核OS中的上下文切换
为了改善运行效率，可以重新把OS 的一些常用基本功能，由服务器移入微内核中。这样可
使客户对OS常用基本功能的请求所引发的用户/内核模式和上下文的切换次数，由4次或8次降为
2次。但这又会使微内核的容量明显增大，使其在小型接口定义和适应性方面的优势有所下降，
同时会提高微内核的设计代价。
1.6.5 外核结构
在传统OS中，只有内核可以管理硬件资源，应用程序通过内核提供的抽象接口间接地与硬
件进行交互。随着计算机产业的逐步发展，应用程序的需求多样性开始增加，内核提供的接口
因具有固定性而成为应用程序提升性能、增强灵活性和拓展功能的瓶颈。但是，应用程序的需
求一直在发生变化，这使得OS为每个应用程序的每种需求都提供一个接口并不现实。因此，传
统OS难以适应应用程序的个性化需求。
外核（exokernel）或外内核OS的基本思想是：内核不提供传统OS中的进程、虚拟存储器等
抽象事物，而是专注于物理资源的隔离（保护）与复用。具体来说，在基于外核结构的OS中，
一个非常小的内核负责保护系统资源，而硬件资源的管理职责则委托给应用程序。这样，OS就
可以做到在保证资源安全的前提下，减少对应用程序的限制，充分满足应用程序对硬件资源的
不同需求。图1-12所示为美国麻省理工学院实现的具有外核结构的 Aegis系统，这个系统由一个
轻量级内核和库OS组成。外核只提供比较低层的硬件操作，在外核接口上层工作的库OS则提供
更高级别的映射。这里的库OS的实现思想是：基于应用程序的需求来定制OS内核，将原本属于
OS内核的功能以库的形式提供给用户。

--- Page 55 ---
34
计算机操作系统 （慕课版）
浏览器
万维网服务
外核
帧缓冲区 页表缓冲区 网络设备 存储器 硬件
库OS
应用程序
POSIX TCP
图1-12  具有外核结构的Aegis系统
1.7 系统调用
程序接口是OS专门为用户程序而设置的，被提供给了程序员在编程时使用，其也是用户程
序取得OS服务的唯一途径。程序接口由一组系统调用（system call）组成，因此可以说，系统
调用提供了用户程序和OS内核之间的接口。系统调用不仅可供所有的应用程序使用，还可供OS
自身使用。在每个系统中，通常有几十条甚至上百条系统调用，可根据功能将它们划分成若干
类。每一个系统调用都是一个能完成特定功能的子程序。
1.7.1 系统调用的基本概念
在OS中提供系统调用的目的是，使应用程序可以通过系统调用来间接调用OS中的相关过
程，进而取得相应的服务。系统调用在本质上是应用程序请求OS内核完成某功能时的一种过程
调用，但它是一种特殊的过程调用，它与一般的过程调用在下述几方面有着显著差别。
（1）运行在不同的系统状态。一般的过程调用，其调用程序和被调用程序运行在相同的状
态——内核态或用户态；而系统调用与一般的过程调用的最大区别就在于，系统调用的调用程
序运行在用户态，而被调用程序运行在内核态。
（2）状态的转换 。由于一般的过程调用并不涉及系统状态的转换，因此可直接由调用过
程转向被调用过程。但在运行系统调用时，由于调用过程和被调用过程工作处于不同的系统状
态，因而不允许由调用过程直接转向被调用过程，需要通过软中断机制先由用户态转换为内核
态，经内核分析后才能转向相应的系统调用处理子程序。
（3）返回问题。在采用了抢占式（剥夺）调度方式的系统中，在被调用过程执行完成后，
要对系统中所有要求运行的进程做优先级分析。当调用进程仍具有最高优先级时，才返回到调
用进程继续执行；否则，将重新调度，以便让优先级最高的进程优先执行。此时，将把调用进
程放入就绪队列。
（4）嵌套调用 。像一般的过程调用一样，系统调用也可以嵌套进行，即在一个被调用过
程执行期间，还可以利用系统调用命令去调用另一个系统调用。当然，每个系统调用对嵌套调
用的深度都有一定的限制，如最大深度为6 。但一般的过程调用对嵌套调用的深度则没有限制。  
图1-13所示为无嵌套调用与有嵌套调用这两种情况下的系统调用。
操作系统服务
与接口


--- Page 56 ---
35
第
1章 
操作系统引论
（a）无嵌套调用 （b）有嵌套调用
用户程序 用户程序
系统功能 系统功能
系统子功能
系统调用
命令
系统调用
命令
系统调用
命令调用
返回 返回
调用
调用
返回
图1-13  系统调用
我们可以通过一个简单的例子，来说明在用户程序中是如何使用系统调用的。例如，要写
一个简单的程序，用于从一个文件中读出数据，再将该数据复制到另一文件中。为此，首先须
输入该程序的输入文件名和输出文件名。文件名可用多种方式指定，其中一种方式是由程序来
询问用户这两个文件名。在交互式系统中，该方式要使用一系列的系统调用，先在屏幕上打印
出一系列的提示信息，再从键盘终端读入定义这两个文件名的字符串。
在获得两个文件名后，程序又必须利用系统调用open 去打开输入文件，并用系统调用creat
去创建指定的输出文件；在执行系统调用open时，又可能发生错误。例如，程序试图去打开一
个不存在的文件，或者该文件虽然存在，但并不允许被访问等。此时，程序又须利用多条系统
调用去显示出错信息，继而利用一个系统调用去实现程序的异常终止。类似地，在执行系统调
用creat时，同样可能出现错误。例如，系统中早已有了与输出文件同名的另一文件，这时又须
利用一个系统调用来结束程序，或者利用一个系统调用来删除已存在的那个同名文件，此后再
利用系统调用creat来创建输出文件。
在打开输入文件和创建输出文件都获得成功后，还须通过用于申请内存的系统调用alloc来
根据文件的大小申请一个缓冲区。申请成功后，再利用系统调用read从输入文件中把数据读到缓
冲区内。读完后，又用系统调用close去关闭输入文件。然后，利用系统调用write把缓冲区内的
数据写到输出文件中。在读过程或写过程中，都有可能需要回送各种出错信息。例如，在写过
程中，可能发现已到达文件末尾指定的字符数尚未读够，或者遇见各种与输出设备类型有关的
错误（如已无磁盘空间、打印机缺纸等）；在读过程中，可能发现硬件故障，如奇偶校验错误
等。在将整个文件复制完后，程序又须利用系统调用close 去关闭输出文件，并向控制台发出一
消息，以指示复制完毕。最后，再利用系统调用exit使程序正常结束。综上所述可知，一个用户
程序需要频繁地利用各种系统调用来取得OS所提供的多种服务。 
系统调用是通过中断机制实现的，并且一个OS的所有系统调用都通过同一个中断入口来实
现。例如，MS-DOS系统提供了INT 21H这一中断，应用程序通过该中断获取OS的服务。
对于拥有保护机制的OS来说，中断机制本身也是受保护的。在IBM公司所生产的个人计算
机上，Intel提供了多达255个中断号，但只有授权给应用程序保护等级的中断号，才是可以被
应用程序调用的。对于未被授权的中断号，如果应用程序对其进行调用，则会引发保护异常，
进而导致自己被OS停止。例如，Linux系统仅给应用程序授权了4 个中断号，即3H 、4H、5H、
80H，前3个中断号是提供给应用程序进行调试所使用的，而80H则是用于系统调用的中断号。
1.7.2 系统调用的类型
现在所有的通用OS都提供了许多系统调用，但它们所提供的系统调用会有一定的差异。对

--- Page 57 ---
36
计算机操作系统 （慕课版）
于一般的通用OS而言，可将系统调用分为以下几大类。
1．进程控制类系统调用
主要用于控制进程的系统调用如下。①创建和终止进程的系统调用。利用创建进程的系统
调用为想要参加并发执行的程序创建一个进程，当进程执行结束后，再利用终止进程的系统调
用来终止该进程。②获得和设置进程属性的系统调用。进程的属性包括进程标识符、进程优先
级、最大允许执行时间等。利用获得进程属性的系统调用可了解某进程的属性，利用设置进程
属性的系统调用可确定和重新设置进程的属性。③等待某事件出现的系统调用。进程在执行过
程中，假设需要等待某事件（条件）出现后方可继续执行。此时，进程可利用等待某事件出现
的系统调用来使自己处于等待状态，一旦等待的事件出现，便可将自己唤醒。
2．文件操纵类系统调用
主要用于操纵文件的系统调用如下。①创建和删除文件的系统调用。利用创建文件的系
统调用，请求系统创建一个新文件；利用删除文件的系统调用，将指定文件删除。②打开和关
闭文件的系统调用。用户在第一次访问某个文件之前，应先利用打开文件的系统调用将指定文
件打开；在访问结束后，应利用关闭文件的系统调用将指定文件关闭。③读和写文件的系统调
用。用户可利用读文件的系统调用，从已打开的文件中读出给定数目的字符，并将它们送至指
定的缓冲区中；也可利用写文件的系统调用，从指定的缓冲区中将给定数目的字符写入文件
中。读和写文件的系统调用是文件操纵类中使用最频繁的系统调用。
3．进程通信类系统调用
在单处理机系统中，OS经常会采用信息传递方式和共享存储区方式。①当采用信息传
递方式时，在通信前须先打开一个连接。为此，应由源进程发出一条打开连接的系统调用，
而目标进程则应利用接受连接的系统调用表示同意进行通信；然后，在源进程和目标进程之
间便可开始通信。可以利用发送信息的系统调用和接收信息的系统调用来交换信息。通信结
束后，还须利用关闭连接的系统调用来结束通信。②当采用共享存储区方式时，在通信前须
先利用建立共享存储区的系统调用来建立一个共享存储区，再利用建立连接的系统调用将该
共享存储区连接到进程自身的虚地址空间上，然后便可利用读和写共享存储区的系统调用来
实现相互通信。
除了上述的3 大类系统调用外，常用的系统调用还包括设备管理类系统调用和信息维护类
系统调用，前者主要用于实现申请设备、释放设备、设备 I/O重定向、获得和设置设备属性等功
能，后者主要用于获得包括有关系统和文件的时间信息、OS版本、当前用户以及有关空闲内存
和磁盘空间大小等多方面的信息。
1.8 本章小结
一个完整的计算机系统由硬件和软件组成。硬件是软件得以建立和开展活动的基础，而软
件则是对硬件功能的扩充。OS是裸机之上的第一层系统软件，它向下管理系统中各类资源，向
上为用户和程序提供服务。
本章主要介绍了OS的目标、作用、发展过程、基本特征、运行环境、主要功能、结构以及
系统调用等内容。

--- Page 58 ---
37
第
1章 
操作系统引论
OS的发展过程很长，从OS开始替代操作人员到发展出现代多道程序系统，这一过程中依次
发展出了多种类型的OS，具体而言，有早期的批处理系统、分时系统、实时系统，还有现代的
微机OS、嵌入式OS、网络OS和分布式OS等。
OS具有并发、共享、虚拟和异步等特征，其运行需要硬件支持。为了保护系统不被破坏，
处理机的运行模式可分为两种，即用户态和内核态，可能引起系统危险的特权指令只能运行在
内核态中。OS是中断驱动的，因此中断和异常是计算机系统中的一个重要机制，它保证了OS的
正常运行。
传统OS具备的功能包括：进程管理、内存管理、设备管理、文件管理和接口管理。现代OS
除了具备传统OS所具备的功能外，还具备保障系统安全、支持用户通过联网获取服务、可处理
多媒体信息等功能。
OS是一个大型的系统软件，采用结构化的设计很重要。早期的OS基本无结构，现代流行的
OS则多采用模块化结构、分层式结构、微内核结构等设计而成，最新的OS有的还是采用外核结
构设计而成的。
系统调用是OS内核与用户程序之间的接口，每个OS都提供了大量的系统调用给程序员  
使用。
习题1（含考研真题）
一、简答题
1．在计算机系统上配置OS的目标是什么？作用主要表现在哪几个方面？
2．试说明OS与硬件、其他系统软件以及用户之间的关系。
3．试说明推动OS发展的主要动力是什么。
4．在OS中，何谓脱机I/O方式和联机I/O方式？
5．试说明推动分时系统形成和发展的主要动力是什么。
6．实现分时系统的关键问题是什么？应如何解决？
7．为什么要引入实时系统？
8．什么是HRT任务和SRT任务？试举例说明。
9．试从及时性、交互性及可靠性方面对分时系统与实时系统进行比较。
10．微机OS按运行方式来分，可以分为哪几类？举例说明。
11．OS具有哪几大特征？它们之间有何关系？
12．是什么原因使OS具有异步特征？
13．何谓OS内核？OS内核的主要功能是什么？
14．何谓原语？何谓原子操作？
15．简要描述处理机的双重工作模式。
16．简述中断处理过程。
17．处理机管理有哪些主要功能？它们的主要任务是什么？
18．存储器管理有哪些主要功能？它们的主要任务是什么？
19．设备管理有哪些主要功能？它们的主要任务是什么？
20．文件管理有哪些主要功能？它们的主要任务是什么？

--- Page 59 ---
38
计算机操作系统 （慕课版）
21．现代OS的新功能有哪些？
22．什么是微内核OS？它具有哪些优点？
23．外核OS的基本思想是什么？
24．什么是系统调用？系统调用与一般用户程序和库函数有何区别？
二、计算题
25．设有3道程序A、B、C，它们按照优先次序（A→B→C）顺序执行，它们的计算时间和
I/O操作时间如表1-1所示，假设3道程序以串行方式使用相同的设备进行I/O操作，试画出单道程
序运行和多道程序运行的时间关系图，并计算完成这3道程序所须花费的时间。
表1 -1 　时间表
程序
时间（ms）
计算 I/O操作 计算
A 30 40 10
B 60 30 10
C 20 40 20
26．（考研真题）一个多道批处理系统中仅有 P1 和 P2 两个作业， P2 比 P1 晚 5ms 到达，它
们的计算和 I/O 操作顺序如下。
P1：计算 60ms ， I/O操作 80ms，计算 20ms。
P2：计算 120ms ， I/O操作 40ms，计算 40ms。
不考虑调度和切换时间，请计算完成两个作业需要的最少时间。
三、综合应用题
27．OS的概念、特征和功能是什么？
28．（考研真题）若某计算问题的执行情况如图1-14所示。
时间 0 100 120 160 260 280 320
输入机
处理机
打印机
图1-14  计算问题执行情况
则请回答下列问题。
（1）叙述该计算问题中处理机、输入机和打印机是如何协同工作的。
（2）计算在图1-14所示的执行情况下处理机的利用率。
（3）简述处理机利用率不高的原因。
（4）请画出能提高处理机利用率的执行方案。


--- Page 60 ---
